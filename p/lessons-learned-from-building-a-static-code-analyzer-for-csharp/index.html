<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="I built a Roslyn static code analyzer to allow the use of distributed unions"><title>Lessons learned from building a static code analyzer for C#</title><link rel=canonical href=https://blog.genezini.com/p/lessons-learned-from-building-a-static-code-analyzer-for-csharp/><link rel=alternate href=https://blog.genezini.com/ hreflang=x-default><link rel=stylesheet href=/scss/style.min.e3e9c075987ec9abe7be9200a4fe17175980754b0c822a22c3165916d315251e.css><meta property="og:title" content="Lessons learned from building a static code analyzer for C#"><meta property="og:description" content="I built a Roslyn static code analyzer to allow the use of distributed unions"><meta property="og:url" content="https://blog.genezini.com/p/lessons-learned-from-building-a-static-code-analyzer-for-csharp/"><meta property="og:site_name" content="Daniel Genezini | It works on my machine"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="C#"><meta property="article:tag" content="dotnet"><meta property="article:tag" content="Static Code Analysis"><meta property="article:tag" content="Analyzers"><meta property="article:tag" content="Roslyn"><meta property="article:published_time" content="2023-07-12T20:15:00-03:00"><meta property="article:modified_time" content="2023-07-12T20:15:00-03:00"><meta property="og:image" content="https://blog.genezini.com/p/lessons-learned-from-building-a-static-code-analyzer-for-csharp/cover.jpg"><meta name=twitter:title content="Lessons learned from building a static code analyzer for C#"><meta name=twitter:description content="I built a Roslyn static code analyzer to allow the use of distributed unions"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.genezini.com/p/lessons-learned-from-building-a-static-code-analyzer-for-csharp/cover.jpg"><script async src="https://www.googletagmanager.com/gtag/js?id=G-029SLZEC4C"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-029SLZEC4C",{anonymize_ip:!1})}</script><script async defer data-website-id=05387238-0856-4199-8d28-696e4a1d7322 src=https://sparkling-pixie-afead0.netlify.app/tomato.js></script></head><body class="article-page
//"><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><div class=site-meta><h1 class=site-name><a href=/>It works on my machine</a></h1></div><figure class=site-avatar><a href=/><img src=/img/avatar_hu793066471163999a4414bfb3be66f111_30130_300x0_resize_q75_box.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><span class=site-name>Daniel Genezini</span></header><ol class=social-menu><li><a class=umami--click--socialmenu-GitHub href=https://github.com/dgenezini/ target=_blank title=GitHub><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a class=umami--click--socialmenu-Linkedin href=https://www.linkedin.com/in/danielgenezini/ target=_blank title=Linkedin><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-linkedin" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><rect x="4" y="4" width="16" height="16" rx="2"/><line x1="8" y1="11" x2="8" y2="16"/><line x1="8" y1="8" x2="8" y2="8.01"/><line x1="12" y1="16" x2="12" y2="11"/><path d="M16 16v-3a2 2 0 00-4 0"/></svg></a></li><li><a class=umami--click--socialmenu-Mastodon href=https://mastodon.world/@danielgenezini target=_blank title=Mastodon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-mastodon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18.648 15.254C16.832 17.017 12 16.88 12 16.88a18.262 18.262.0 01-3.288-.256c1.127 1.985 4.12 2.81 8.982 2.475-1.945 2.013-13.598 5.257-13.668-7.636L4 10.309c0-3.036.023-4.115 1.352-5.633C7.023 2.766 12 3.01 12 3.01s4.977-.243 6.648 1.667C19.977 6.195 20 7.274 20 10.31s-.456 4.074-1.352 4.944z"/><path d="M12 11.204V8.278C12 7.02 11.105 6 10 6S8 7.02 8 8.278V13m4-4.722C12 7.02 12.895 6 14 6s2 1.02 2 2.278V13"/></svg></a></li><li><a class=umami--click--socialmenu-Twitter href=https://twitter.com/GeneziniDaniel target=_blank title=Twitter><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Archives</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>Search</span></a></li><li><a href=/follow-me/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-rss" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="5" cy="19" r="1"/><path d="M4 4a16 16 0 0116 16"/><path d="M4 11a9 9 0 019 9"/></svg><span>Follow me</span></a></li><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>Dark Mode</span></li></div></ol></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/p/lessons-learned-from-building-a-static-code-analyzer-for-csharp/><img src=/p/lessons-learned-from-building-a-static-code-analyzer-for-csharp/cover.jpg width=1000 height=563 loading=lazy alt="Featured image of post Lessons learned from building a static code analyzer for C#"></a></div><div class=picture-credits><a href=https://unsplash.com/photos/ZNTPlG050tk target=_blank>Picture by TopSphere Media</a></div><div class=article-details><header class=article-category><a href=/categories/dotnet/ class=umami--click--categories-header--categories-dotnet->.NET</a>
<a href=/categories/c-sharp/ class=umami--click--categories-header--categories-c-sharp->C#</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/lessons-learned-from-building-a-static-code-analyzer-for-csharp/>Lessons learned from building a static code analyzer for C#</a></h2><h3 class=article-subtitle>I built a Roslyn static code analyzer to allow the use of distributed unions</h3></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>12 Jul 2023</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>6 minute read</time>
<a href=/follow-me/ aria-label="Follow me"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-rss" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="5" cy="19" r="1"/><path d="M4 4a16 16 0 0116 16"/><path d="M4 11a9 9 0 019 9"/></svg><span>Follow me</span></a>
<a data-pocket-label=pocket data-save-url=https://blog.genezini.com/p/lessons-learned-from-building-a-static-code-analyzer-for-csharp/ data-pocket-count=none class=pocket-btn data-lang=en></a>
<script type=text/javascript>!function(e,t){if(!e.getElementById(t)){var s,n=e.createElement("script");n.id=t,n.src="https://widgets.getpocket.com/v1/j/btn.js?v=1",s=e.getElementById(t),e.body.appendChild(n)}}(document,"pocket-btn-js")</script></div></footer></div></header><section class=article-content><h2 id=introduction>Introduction <a href=#introduction class=header-link arialabel=Anchor><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Link to this section</title><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></a></h2><p>Static code analyzers are tools used to analyze software code without executing it. They can examine the code to find code smells, vulnerabilities, potential errors, and code out of a defined standard, for example. They work by parsing the source code and evaluating its syntax (structure of the code) and semantic (meaning of the code).</p><p>Roslyn, the C# compiler, provides tools for developing Roslyn Analyzers (Static code analyzers for Roslyn), giving access to the syntax and semantic of the code, that can be executed at development and build time, providing feedback in near real-time to the developers.</p><p>In this post, I&rsquo;ll show a Roslyn Analyzer I built for using Discriminated Unions in C#, requiring to check the union type before access, and talk about some lessons learned while developing it.</p><h2 id=discriminatedunionsnet-package>DiscriminatedUnions.Net package <a href=#discriminatedunionsnet-package class=header-link arialabel=Anchor><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Link to this section</title><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></a></h2><p>The package allows the use of Discriminated Unions by enforcing two rules:</p><ol><li>The type of a Union must be checked before access;</li><li>All types of a Union must be checked (or have an <code>else</code>/<code>default</code>/<code>discard</code> case).</li></ol><p>To use the package, install it in the project:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&lt;PackageReference <span class=nv>Include</span><span class=o>=</span><span class=s2>&#34;DiscriminatedUnions.Net&#34;</span> <span class=nv>Version</span><span class=o>=</span><span class=s2>&#34;1.0.0.19&#34;</span> /&gt;
</span></span></code></pre></div><p>Extend <code>UnionValue</code> when declaring the types that will be used in the Discriminated Union:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>Bird</span><span class=p>:</span> <span class=n>UnionValue</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>Dog</span> <span class=p>:</span> <span class=n>UnionValue</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Declare the <code>Union</code> member passing the possible value types:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=n>Union</span><span class=p>&lt;</span><span class=n>Dog</span><span class=p>,</span> <span class=n>Bird</span><span class=p>&gt;</span> <span class=n>animal</span> <span class=p>=</span> <span class=k>new</span> <span class=n>Dog</span><span class=p>();</span>
</span></span></code></pre></div><p>And access it checking for the type with <code>If</code>, <code>Switch/Case</code> or <code>Pattern Matching</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=n>animal</span><span class=p>.</span><span class=n>Value</span> <span class=k>is</span> <span class=n>Dog</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Console</span><span class=p>.</span><span class=n>WriteLine</span><span class=p>(</span><span class=s>$&#34;Dog: {animal.Value}&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=k>else</span>
</span></span><span class=line><span class=cl><span class=p>...</span>
</span></span></code></pre></td></tr></table></div></div><p>Accessing the object without checking will yield an error <code>DUN002 - 'animal.Value' not checked before access</code>:</p><p><img src=/p/lessons-learned-from-building-a-static-code-analyzer-for-csharp/images/DUN002_NotCheckedBeforeAccess.png width=515 height=197 loading=lazy alt="DUN002 - &lsquo;animal.Value&rsquo; not checked before access" class=gallery-image data-flex-grow=261 data-flex-basis=627px></p><p>Not checking for all possible types will yield an error <code>DUN001 - 'animal' not being evaluated for all possible types</code>:</p><p><img src=/p/lessons-learned-from-building-a-static-code-analyzer-for-csharp/images/DUN001_NotBeingEvaluatedForAllPossibleTypes.png width=450 height=164 loading=lazy alt="DUN001 - &lsquo;animal&rsquo; not being evaluated for all possible types" class=gallery-image data-flex-grow=274 data-flex-basis=658px></p><blockquote><p>‚ö†Ô∏è <strong>This package was made for study purposes only</strong>. Feel free to test it, but won&rsquo;t use it for production code as it won&rsquo;t be maintained and may not cover all edge cases.</p></blockquote><h2 id=discriminatedunionsnet-source-code>DiscriminatedUnions.NET Source Code <a href=#discriminatedunionsnet-source-code class=header-link arialabel=Anchor><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Link to this section</title><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></a></h2><p><a class=link href=https://github.com/dgenezini/DiscriminatedUnions.NET target=_blank rel=noopener>https://github.com/dgenezini/DiscriminatedUnions.NET</a></p><h2 id=lessons-learned>Lessons learned <a href=#lessons-learned class=header-link arialabel=Anchor><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Link to this section</title><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></a></h2><h3 id=development-time-only-nuget-packages>Development-time only nuget packages <a href=#development-time-only-nuget-packages class=header-link arialabel=Anchor><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Link to this section</title><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></a></h3><p>Roslyn analyzers can be distributed as nuget packages, but it is important to generate the package as a Development Dependency only, setting the property <code>DevelopmentDependency</code> as <code>true</code> on the <code>csproj</code> file:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;DevelopmentDependency&gt;</span>true<span class=nt>&lt;/DevelopmentDependency&gt;</span>
</span></span></code></pre></div><p>This will generate two tags in the nuget package properties of the consumer projects:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;PackageReference</span> <span class=na>Include=</span><span class=s>&#34;DiscriminatedUnions.Net.Analyzers&#34;</span> <span class=na>Version=</span><span class=s>&#34;1.0.0.1&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;PrivateAssets&gt;</span>all<span class=nt>&lt;/PrivateAssets&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;IncludeAssets&gt;</span>runtime; build; native; contentfiles; analyzers; buildtransitive<span class=nt>&lt;/IncludeAssets&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/PackageReference&gt;</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><code>PrivateAssets</code> with the value <code>all</code>, indicating that this package won&rsquo;t flow to projects depending on the consumer project. For example, in a scenario where <code>Project1</code> depends on the <code>DiscriminatedUnions.Net.Analyzers</code> package and <code>Project2</code> depends on <code>Project1</code>, the analyzer won&rsquo;t be available for <code>Project2</code>;</li><li><code>IncludeAssets</code> without the <code>compile</code> value in its value, indicating the consumer of the package won&rsquo;t have access to its compiled assemblies.</li></ul><h3 id=roslyn-analyzers-can-be-used-to-enforce-rules-on-how-to-use-a-package>Roslyn Analyzers can be used to enforce rules on how to use a package <a href=#roslyn-analyzers-can-be-used-to-enforce-rules-on-how-to-use-a-package class=header-link arialabel=Anchor><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Link to this section</title><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></a></h3><p>A great use case for Roslyn Analyzers is to enforce rules on nuget packages.</p><p>The DistributedUnion.Net package is one example. It has the <code>Union</code> and <code>UnionValue</code> types and analyzers to enforce the rules on its use.</p><p>Because classes inside Analyzers packages are not accessible by consumers (and shouldn&rsquo;t be), the most correct way, in my opinion, is to have the public classes in one package and this package will consume another package with the analyzers, but removing the <code>PrivateAssets</code> configuration. This way, the analyzers will be available for consumers of the parent package:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;PackageReference</span> <span class=na>Include=</span><span class=s>&#34;DiscriminatedUnions.Net.Analyzers&#34;</span> <span class=na>Version=</span><span class=s>&#34;0.1.0.0-beta&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;IncludeAssets&gt;</span>runtime; build; native; contentfiles; analyzers; buildtransitive<span class=nt>&lt;/IncludeAssets&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/PackageReference&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=/p/lessons-learned-from-building-a-static-code-analyzer-for-csharp/images/Dependencies.PNG width=364 height=162 loading=lazy alt="Project dependency showing the DiscriminatedUnions.Net and DiscriminatedUnions.Net.Analyzers" class=gallery-image data-flex-grow=224 data-flex-basis=539px></p><h3 id=analyzers-have-to-evolve-together-with-the-language>Analyzers have to evolve together with the language <a href=#analyzers-have-to-evolve-together-with-the-language class=header-link arialabel=Anchor><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Link to this section</title><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></a></h3><p>Because analyzers use the code syntax, as new ways of doing something are added to the language, analyzers have to be updated to treat them also. For example:</p><ul><li>An analyzer checking for conditions before pattern matching was release, would need to be updated to consider this new syntax;</li><li>An analyzer using types for its rules, would need to be updated to consider nullable reference types in its logic.</li></ul><h3 id=tdd-is-your-friend>TDD is your friend <a href=#tdd-is-your-friend class=header-link arialabel=Anchor><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Link to this section</title><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></a></h3><p>The Roslyn Analyzers project template comes with a VSIX project that can be run to test the analyzers, but I couldn&rsquo;t get them to work and decided it wasn&rsquo;t worth the time.</p><p>Turns out the best and easiest way to run and experiment with the analyzer is by running automated tests. Create the test, run the test and change the analyzer until the test passes.</p><p>Example of an automated test that expects the error code <code>DUN001</code> at the location <code>0</code> with the argument <code>unionBird</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=na>[TestMethod]</span>
</span></span><span class=line><span class=cl>        <span class=kd>public</span> <span class=kd>async</span> <span class=n>Task</span> <span class=n>Notify_If_NotCheckingAllCases_Many</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kt>var</span> <span class=n>test</span> <span class=p>=</span> <span class=s>@&#34;
</span></span></span><span class=line><span class=cl><span class=s>using DiscriminatedUnionsNet;
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>class Program
</span></span></span><span class=line><span class=cl><span class=s>{
</span></span></span><span class=line><span class=cl><span class=s>    static string GetValue()
</span></span></span><span class=line><span class=cl><span class=s>    {
</span></span></span><span class=line><span class=cl><span class=s>        Union&lt;Duck, Goose, Eagle, Crow&gt; unionBird = new Duck();
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>        if ({|#0:unionBird|}.Value is Goose)
</span></span></span><span class=line><span class=cl><span class=s>        {
</span></span></span><span class=line><span class=cl><span class=s>            return &#34;&#34;Goose&#34;&#34;;
</span></span></span><span class=line><span class=cl><span class=s>        }
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>        return null;
</span></span></span><span class=line><span class=cl><span class=s>    }
</span></span></span><span class=line><span class=cl><span class=s>}&#34;</span> <span class=p>+</span> <span class=n>defineUnion</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=kt>var</span> <span class=n>expected</span> <span class=p>=</span> <span class=n>VerifyCS</span>
</span></span><span class=line><span class=cl>                <span class=p>.</span><span class=n>Diagnostic</span><span class=p>(</span><span class=s>&#34;DUN001&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>.</span><span class=n>WithLocation</span><span class=p>(</span><span class=m>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>.</span><span class=n>WithArguments</span><span class=p>(</span><span class=s>&#34;unionBird&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>await</span> <span class=n>VerifyCS</span><span class=p>.</span><span class=n>VerifyAnalyzerAsync</span><span class=p>(</span><span class=n>test</span><span class=p>,</span> <span class=n>expected</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>The location and argument are marked with the <code>{|#location:argument|}</code> syntax.</p><p><img src=/p/lessons-learned-from-building-a-static-code-analyzer-for-csharp/images/UnitTests.png width=721 height=293 loading=lazy alt="Automated tests" class=gallery-image data-flex-grow=246 data-flex-basis=590px></p><blockquote><p>‚ÑπÔ∏è The project template comes with some basic tests as examples that are easy to change.</p></blockquote><h3 id=casts-casts-everywhere>Casts&mldr; Casts everywhere <a href=#casts-casts-everywhere class=header-link arialabel=Anchor><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Link to this section</title><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></a></h3><p>The analyzers methods and properties define general interface types that need to be cast to the specific type before accessing its properties.</p><p>This is an excerpt from the DiscriminatedUnions.Net package:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=kt>var</span> <span class=n>namedType</span> <span class=p>=</span> <span class=p>(</span><span class=n>INamedTypeSymbol</span><span class=p>)</span><span class=n>typeInfo</span><span class=p>.</span><span class=n>Type</span><span class=p>;</span> <span class=c1>//typeInfo.Type is ITypeSymbol</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>((!</span><span class=n>namedType</span><span class=p>.</span><span class=n>Name</span><span class=p>.</span><span class=n>Equals</span><span class=p>(</span><span class=s>&#34;UnionValue&#34;</span><span class=p>))</span> <span class=p>||</span>
</span></span><span class=line><span class=cl>    <span class=p>(!</span><span class=n>namedType</span><span class=p>.</span><span class=n>ContainingNamespace</span><span class=p>.</span><span class=n>Name</span><span class=p>.</span><span class=n>Equals</span><span class=p>(</span><span class=s>&#34;DiscriminatedUnionsNet&#34;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=n>parent</span> <span class=k>is</span> <span class=n>ISwitchOperation</span> <span class=n>switchOperation</span><span class=p>)</span> <span class=c1>//parent is IOperation</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(!(</span><span class=n>switchOperation</span><span class=p>.</span><span class=n>Value</span> <span class=k>is</span> <span class=n>IPropertyReferenceOperation</span> <span class=n>propertyReferenceOperation</span><span class=p>)</span> <span class=p>||</span> <span class=c1>//switchOperation.Value is IOperation</span>
</span></span><span class=line><span class=cl>        <span class=p>!(</span><span class=n>propertyReferenceOperation</span><span class=p>.</span><span class=n>Instance</span> <span class=k>is</span> <span class=n>ILocalReferenceOperation</span> <span class=n>parentReferenceOperation</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>parent</span> <span class=p>=</span> <span class=n>parent</span><span class=p>.</span><span class=n>Parent</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>continue</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>...</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>parent</span> <span class=k>is</span> <span class=n>ISwitchExpressionOperation</span> <span class=n>switchExpressionOperation</span><span class=p>)</span> <span class=c1>//parent is IOperation</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=p>...</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=understanding-the-syntax-tree-and-finding-the-correct-interfaces>Understanding the syntax tree and finding the correct interfaces <a href=#understanding-the-syntax-tree-and-finding-the-correct-interfaces class=header-link arialabel=Anchor><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Link to this section</title><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></a></h3><p>The easiest way to understand the syntax tree is by using the Visual Studio&rsquo;s Syntax Visualizer (<a class=link href="https://learn.microsoft.com/en-us/dotnet/csharp/roslyn-sdk/syntax-visualizer?tabs=csharp#installation-instructions---visual-studio-installer" target=_blank rel=noopener>Installation instructions</a>).</p><p>Just click anywhere in the code and it will show the syntax tree up to that point:</p><p><img src=/p/lessons-learned-from-building-a-static-code-analyzer-for-csharp/images/SyntaxVisualizer.PNG width=1185 height=421 loading=lazy alt="Syntax Visualizer" class=gallery-image data-flex-grow=281 data-flex-basis=675px></p><p>Another tip is to type <code>ISymbol</code>, <code>IOperation</code>, or any base interface to see all the specific interfaces in the intellisense:</p><p><img src=/p/lessons-learned-from-building-a-static-code-analyzer-for-csharp/images/ISymbolSuggestions.png width=761 height=253 loading=lazy alt="Intellisense showing all ISymbol interfaces" class=gallery-image data-flex-grow=300 data-flex-basis=721px></p><h3 id=not-many-material-to-help-beginners>Not many material to help beginners <a href=#not-many-material-to-help-beginners class=header-link arialabel=Anchor><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Link to this section</title><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></a></h3><p>Because Roslyn Analyzers have very specific use cases, there is not a lot of materials and documentation online. Here are some links that helped me learn (specially Josh Varty&rsquo;s and Meziantou&rsquo;s Blog):</p><p><a class=link href=https://joshvarty.com/learn-roslyn-now/ target=_blank rel=noopener>Josh Varty&rsquo;s Blog - Learn Roslyn Now series</a></p><p><a class=link href=https://www.meziantou.net/writing-a-roslyn-analyzer.htm target=_blank rel=noopener>Meziantou&rsquo;s Blog - Writing a Roslyn analyzer series</a></p><p><a class=link href=https://roslyn-analyzers.readthedocs.io/en/latest/how-to-start.html target=_blank rel=noopener>Roslyn docs - How to start</a></p><p><a class=link href=https://github.com/dotnet/roslyn/blob/main/docs/wiki/How-To-Write-a-C%23-Analyzer-and-Code-Fix.md target=_blank rel=noopener>Roslyn GitHub docs - How to write a C# Analyzer and Code Fix</a></p><p><a class=link href=https://github.com/dotnet/roslyn/blob/main/docs/analyzers/Analyzer%20Actions%20Semantics.md target=_blank rel=noopener>Roslyn GitHub docs - Analyzer Actions Semantics</a></p></section><footer class=article-footer><style>.comment-content{margin:var(--card-padding)0;color:var(--card-text-color-main);font-family:var(--article-font-family);font-size:calc(var(--article-font-size) * 1.1);line-height:var(--article-line-height)}</style><span class=comment-content>üí¨ Like or have something to add? <a href=#comments>Leave a comment below</a>.</span><style>.resp-sharing-button__link,.resp-sharing-button__icon{display:inline-block}.resp-sharing-button__link{text-decoration:none;color:#fff;margin:0 .5em .5em 0}.resp-sharing-button{border-radius:5px;transition:25ms ease-out;padding:.5em .75em;font-family:Helvetica Neue,Helvetica,Arial,sans-serif}.resp-sharing-button__icon svg{width:1em;height:1em;margin-right:.4em;vertical-align:top}.resp-sharing-button--small svg{margin:0;vertical-align:middle}.resp-sharing-button__icon{stroke:#fff;fill:none}.resp-sharing-button__icon--solid,.resp-sharing-button__icon--solidcircle{fill:#fff;stroke:none}.resp-sharing-button--twitter{background-color:#55acee}.resp-sharing-button--twitter:hover{background-color:#2795e9}.resp-sharing-button--pinterest{background-color:#bd081c}.resp-sharing-button--pinterest:hover{background-color:#8c0615}.resp-sharing-button--facebook{background-color:#3b5998}.resp-sharing-button--facebook:hover{background-color:#2d4373}.resp-sharing-button--tumblr{background-color:#35465c}.resp-sharing-button--tumblr:hover{background-color:#222d3c}.resp-sharing-button--reddit{background-color:#ff4500}.resp-sharing-button--reddit:hover{background-color:#d43b03}.resp-sharing-button--google{background-color:#dd4b39}.resp-sharing-button--google:hover{background-color:#c23321}.resp-sharing-button--linkedin{background-color:#0077b5}.resp-sharing-button--linkedin:hover{background-color:#046293}.resp-sharing-button--email{background-color:#777}.resp-sharing-button--email:hover{background-color:#5e5e5e}.resp-sharing-button--xing{background-color:#1a7576}.resp-sharing-button--xing:hover{background-color:#114c4c}.resp-sharing-button--whatsapp{background-color:#25d366}.resp-sharing-button--whatsapp:hover{background-color:#1da851}.resp-sharing-button--hackernews{background-color:#f60}.resp-sharing-button--hackernews:hover,.resp-sharing-button--hackernews:focus{background-color:#fb6200}.resp-sharing-button--vk{background-color:#507299}.resp-sharing-button--vk:hover{background-color:#43648c}.resp-sharing-button--facebook{background-color:#3b5998;border-color:#3b5998}.resp-sharing-button--facebook:hover,.resp-sharing-button--facebook:active{background-color:#2d4373;border-color:#2d4373}.resp-sharing-button--twitter{background-color:#55acee;border-color:#55acee}.resp-sharing-button--twitter:hover,.resp-sharing-button--twitter:active{background-color:#2795e9;border-color:#2795e9}.resp-sharing-button--tumblr{background-color:#35465c;border-color:#35465c}.resp-sharing-button--tumblr:hover,.resp-sharing-button--tumblr:active{background-color:#222d3c;border-color:#222d3c}.resp-sharing-button--email{background-color:#777;border-color:#777}.resp-sharing-button--email:hover,.resp-sharing-button--email:active{background-color:#5e5e5e;border-color:#5e5e5e}.resp-sharing-button--pinterest{background-color:#bd081c;border-color:#bd081c}.resp-sharing-button--pinterest:hover,.resp-sharing-button--pinterest:active{background-color:#8c0615;border-color:#8c0615}.resp-sharing-button--linkedin{background-color:#0077b5;border-color:#0077b5}.resp-sharing-button--linkedin:hover,.resp-sharing-button--linkedin:active{background-color:#046293;border-color:#046293}.resp-sharing-button--reddit{background-color:#ff4500;border-color:#bb3200}.resp-sharing-button--reddit:hover,.resp-sharing-button--reddit:active{background-color:#d43b03;border-color:#bb3200}.resp-sharing-button--feedly{background-color:#2bb24c}.resp-sharing-button--feedly:hover{background-color:#249440}.resp-sharing-button--feedly{background-color:#2bb24c;border-color:#2bb24c}.resp-sharing-button--feedly:hover,.resp-sharing-button--feedly:active{background-color:#249440;border-color:#249440}.resp-sharing-button--rss{background-color:#f26522}.resp-sharing-button--rss:hover{background-color:#cc541d}.resp-sharing-button--rss{background-color:#f26522;border-color:#f26522}.resp-sharing-button--rss:hover,.resp-sharing-button--rss:active{background-color:#cc541d;border-color:#cc541d}.resp-sharing-button--mastodon{background-color:#6364ff}.resp-sharing-button--mastodon:hover{background-color:#4646cc}.resp-sharing-button--mastodon{background-color:#6364ff;border-color:#6364ff}.resp-sharing-button--mastodon:hover,.resp-sharing-button--mastodon:active{background-color:#4646cc;border-color:#4646cc}.share-on-title{display:block;font-size:1.5em;margin-block-start:.83em;margin-block-end:.83em;margin-inline-start:0;margin-inline-end:0;font-weight:700;color:var(--card-text-color-main)}</style><span class=share-on-title>Follow me</span><div><a class="resp-sharing-button__link umami--click--follow-feedly" href=https://feedly.com/i/subscription/feed/https://blog.genezini.com/index.xml target=_blank value=Subscribe aria-label=Subscribe><div class="resp-sharing-button resp-sharing-button--feedly resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-rss" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="5" cy="19" r="1"/><path d="M4 4a16 16 0 0116 16"/><path d="M4 11a9 9 0 019 9"/></svg></div>Feedly</div></a><a class="resp-sharing-button__link umami--click--follow-rss" href=/index.xml target=_blank value=Subscribe aria-label=Subscribe><div class="resp-sharing-button resp-sharing-button--rss resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-rss" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="5" cy="19" r="1"/><path d="M4 4a16 16 0 0116 16"/><path d="M4 11a9 9 0 019 9"/></svg></div>RSS</div></a><a class="resp-sharing-button__link umami--click--follow-twitter" href=https://twitter.com/GeneziniDaniel target=_blank rel=noopener aria-label=Twitter><div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M23.44 4.83c-.8.37-1.5.38-2.22.02.93-.56.98-.96 1.32-2.02-.88.52-1.86.9-2.9 1.1-.82-.88-2-1.43-3.3-1.43-2.5.0-4.55 2.04-4.55 4.54.0.36.03.7.1 1.04-3.77-.2-7.12-2-9.36-4.75-.4.67-.6 1.45-.6 2.3.0 1.56.8 2.95 2 3.77-.74-.03-1.44-.23-2.05-.57v.06c0 2.2 1.56 4.03 3.64 4.44-.67.2-1.37.2-2.06.08.58 1.8 2.26 3.12 4.25 3.16C5.78 18.1 3.37 18.74 1 18.46c2 1.3 4.4 2.04 6.97 2.04 8.35.0 12.92-6.92 12.92-12.93.0-.2.0-.4-.02-.6.9-.63 1.96-1.22 2.56-2.14z"/></svg></div>Twitter</div></a><a class="resp-sharing-button__link umami--click--follow-linkedin" href=https://www.linkedin.com/in/danielgenezini/ target=_blank rel=noopener aria-label=LinkedIn><div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6.5 21.5h-5v-13h5v13zM4 6.5C2.5 6.5 1.5 5.3 1.5 4s1-2.4 2.5-2.4c1.6.0 2.5 1 2.6 2.5.0 1.4-1 2.5-2.6 2.5zm11.5 6c-1 0-2 1-2 2v7h-5v-13h5V10s1.6-1.5 4-1.5c3 0 5 2.2 5 6.3v6.7h-5v-7c0-1-1-2-2-2z"/></svg></div>LinkedIn</div></a><a class="resp-sharing-button__link umami--click--follow-mastodon" href=https://mastodon.world/@danielgenezini target=_blank rel=noopener aria-label=Mastodon><div class="resp-sharing-button resp-sharing-button--mastodon resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-mastodon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18.648 15.254C16.832 17.017 12 16.88 12 16.88a18.262 18.262.0 01-3.288-.256c1.127 1.985 4.12 2.81 8.982 2.475-1.945 2.013-13.598 5.257-13.668-7.636L4 10.309c0-3.036.023-4.115 1.352-5.633C7.023 2.766 12 3.01 12 3.01s4.977-.243 6.648 1.667C19.977 6.195 20 7.274 20 10.31s-.456 4.074-1.352 4.944z"/><path d="M12 11.204V8.278C12 7.02 11.105 6 10 6S8 7.02 8 8.278V13m4-4.722C12 7.02 12.895 6 14 6s2 1.02 2 2.278V13"/></svg></div>Mastodon</div></a></div><style>.resp-subscribe-button__link,.resp-subscribe-button__icon{display:inline-block}.resp-subscribe-button__link{text-decoration:none;color:#fff;margin:0 .5em .5em 0}.resp-subscribe-button{border-radius:5px;transition:25ms ease-out;padding:.5em .75em;font-family:Helvetica Neue,Helvetica,Arial,sans-serif}.resp-subscribe-button__icon svg{width:1em;height:1em;margin-right:.4em;vertical-align:top}.resp-subscribe-button--small svg{margin:0;vertical-align:middle}.resp-subscribe-button__icon{stroke:#fff;fill:none}.resp-subscribe-button__icon--solid,.resp-subscribe-button__icon--solidcircle{fill:#fff;stroke:none}.resp-subscribe-button--coffee{background-color:#d9534f}.resp-subscribe-button--coffee:hover{background-color:#c0312c}.resp-subscribe-button--coffee{background-color:#d9534f;border-color:#d9534f}.resp-subscribe-button--coffee:hover,.resp-subscribe-button--coffee:active{background-color:#c0312c;border-color:#c0312c}.resp-subscribe-button--github{background-color:#3b3b3b}.resp-subscribe-button--github:hover{background-color:#292929}.resp-subscribe-button--github{background-color:#3b3b3b;border-color:#3b3b3b}.resp-subscribe-button--github:hover,.resp-subscribe-button--github:active{background-color:#292929;border-color:#292929}.subscribe-title{display:block;font-size:1.5em;margin-block-start:.83em;margin-block-end:.83em;margin-inline-start:0;margin-inline-end:0;font-weight:700;color:var(--card-text-color-main)}</style><span class=subscribe-title>Support me</span><div><a class="resp-subscribe-button__link umami--click--support-kofi" href=https://ko-fi.com/genezini target=_blank value="‚òï Ko-fi" aria-label="‚òï Ko-fi"><div class="resp-subscribe-button resp-subscribe-button--coffee resp-subscribe-button--medium"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-mug" width="16" height="16" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4.083 5h10.834A1.08 1.08.0 0116 6.077v8.615C16 17.072 14.06 19 11.667 19H7.333C4.94 19 3 17.071 3 14.692V6.077A1.08 1.08.0 014.083 5"/><path d="M16 8h2.5c1.38.0 2.5 1.045 2.5 2.333v2.334C21 13.955 19.88 15 18.5 15H16"/></svg>Ko-fi</div></a><a class="resp-subscribe-button__link umami--click--support-github" href=https://github.com/sponsors/dgenezini/ target=_blank value="GitHub Sponsor" aria-label="GitHub Sponsor"><div class="resp-subscribe-button resp-subscribe-button--github resp-subscribe-button--medium"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="16" height="16" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg>GitHub Sponsor</div></a></div><span class=subscribe-title>Tags</span><section class=article-tags><a href=/tags/c-sharp/ class=umami--click--tags-bottom--tags-c-sharp->C#</a>
<a href=/tags/dotnet/ class=umami--click--tags-bottom--tags-dotnet->.NET</a>
<a href=/tags/static-code-analysis/ class=umami--click--tags-bottom--tags-static-code-analysis->Static Code Analysis</a>
<a href=/tags/analyzers/ class=umami--click--tags-bottom--tags-analyzers->Analyzers</a>
<a href=/tags/roslyn/ class=umami--click--tags-bottom--tags-roslyn->Roslyn</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/p/compile-time-null-safety-how-to-avoid-nullreferenceexception-in-c/ class=umami--click--related-bottom-compile-time-null-safety-how-to-avoid-nullreferenceexception-in-c-><div class=article-image><img src=/p/compile-time-null-safety-how-to-avoid-nullreferenceexception-in-c/cover.d8daae92711d3433874dc24aaa198943.jpg width=1000 height=680 loading=lazy alt="Featured image of post Compile-time null safety: How to avoid NullReferenceException in C#" data-hash="md5-2NquknEdNDOHTcJKqhmJQw=="></div><div class=article-details><h2 class=article-title>Compile-time null safety: How to avoid NullReferenceException in C#</h2></div></a></article><article class=has-image><a href=/p/enforcing-.net-code-style-rules-at-compile-time/ class=umami--click--related-bottom-enforcing-net-code-style-rules-at-compile-time-><div class=article-image><img src=/p/enforcing-.net-code-style-rules-at-compile-time/cover.5ae17a9488123306b007150bdb933d3e.png width=1300 height=250 loading=lazy alt="Featured image of post Enforcing .NET code style rules at compile time" data-hash="md5-WuF6lIgSMwawBxUL25M9Pg=="></div><div class=article-details><h2 class=article-title>Enforcing .NET code style rules at compile time</h2></div></a></article><article class=has-image><a href=/p/dont-box-your-logs/ class=umami--click--related-bottom-dont-box-your-logs-><div class=article-image><img src=/p/dont-box-your-logs/cover.f8912ad9a94817b1139e3715dbc96bc0.jpg width=800 height=600 loading=lazy alt="Featured image of post Don't box your logs" data-hash="md5-+JEq2alIF7ETnjcV28lrwA=="></div><div class=article-details><h2 class=article-title>Don't box your logs</h2></div></a></article><article class=has-image><a href=/p/server-side-rendered-spas-with-asp.net-and-no-javascript/ class=umami--click--related-bottom-server-side-rendered-spas-with-aspnet-and-no-javascript-><div class=article-image><img src=/p/server-side-rendered-spas-with-asp.net-and-no-javascript/cover.0d7c75084bb09a9917004d509ad82ec9.jpg width=800 height=528 loading=lazy alt="Featured image of post Server-side rendered SPAs with ASP.NET and no Javascript" data-hash="md5-DXx1CEuwmpkXAE1QmtguyQ=="></div><div class=article-details><h2 class=article-title>Server-side rendered SPAs with ASP.NET and no Javascript</h2></div></a></article><article class=has-image><a href=/p/integration-tests-with-aws-s3-buckets-using-localstack-and-testcontainers/ class=umami--click--related-bottom-integration-tests-with-aws-s3-buckets-using-localstack-and-testcontainers-><div class=article-image><img src=/p/integration-tests-with-aws-s3-buckets-using-localstack-and-testcontainers/cover.ecb76b6a20abd82d3a066774a85488b8.jpg width=800 height=458 loading=lazy alt="Featured image of post Integration tests with AWS S3 buckets using Localstack and Testcontainers" data-hash="md5-7LdraiCr2C06Bmd0qFSIuA=="></div><div class=article-details><h2 class=article-title>Integration tests with AWS S3 buckets using Localstack and Testcontainers</h2></div></a></article></div></div></aside><div id=comments><script src=https://giscus.app/client.js data-repo=dgenezini/BlogComments data-repo-id=R_kgDOJj-XAw data-category=Announcements data-category-id=DIC_kwDOJj-XA84CWiZs data-mapping=og:title data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=light data-lang=en data-loading=lazy crossorigin=anonymous async></script>
<script>function setGiscusTheme(e){let t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:{setConfig:{theme:e}}},"https://giscus.app")}(function(){addEventListener("message",t=>{if(event.origin!=="https://giscus.app")return;e()}),window.addEventListener("onColorSchemeChange",e);function e(){setGiscusTheme(document.documentElement.dataset.scheme==="light"?"light":"dark_dimmed")}})()</script></div><footer class=site-footer><section class=copyright>&copy;
2022 -
2023 Daniel Genezini | It works on my machine</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.13.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main><aside class="sidebar right-sidebar sticky"><section class="widget archives"><h2 class="widget-title section-title">Related content</h2><div class=article-list--mini><article><a href=/p/compile-time-null-safety-how-to-avoid-nullreferenceexception-in-c/ class=umami--click--related-side-compile-time-null-safety-how-to-avoid-nullreferenceexception-in-c-><div class=article-details><h2 class=article-title>Compile-time null safety: How to avoid NullReferenceException in C#</h2><footer class=article-time><time datetime=2023-01-30T07:45:00-03:00>30 Jan 2023</time></footer></div><div class=article-image><img src=/p/compile-time-null-safety-how-to-avoid-nullreferenceexception-in-c/cover.jpg width=1000 height=680 alt="Compile-time null safety: How to avoid NullReferenceException in C#" loading=lazy></div></a></article><article><a href=/p/enforcing-.net-code-style-rules-at-compile-time/ class=umami--click--related-side-enforcing--net-code-style-rules-at-compile-time-><div class=article-details><h2 class=article-title>Enforcing .NET code style rules at compile time</h2><footer class=article-time><time datetime=2022-10-25T08:00:00-03:00>25 Oct 2022</time></footer></div><div class=article-image><img src=/p/enforcing-.net-code-style-rules-at-compile-time/cover.png width=1300 height=250 alt="Enforcing .NET code style rules at compile time" loading=lazy></div></a></article><article><a href=/p/dont-box-your-logs/ class=umami--click--related-side-dont-box-your-logs-><div class=article-details><h2 class=article-title>Don't box your logs</h2><footer class=article-time><time datetime=2023-01-02T07:00:00-03:00>02 Jan 2023</time></footer></div><div class=article-image><img src=/p/dont-box-your-logs/cover.jpg width=800 height=600 alt="Don't box your logs" loading=lazy></div></a></article><article><a href=/p/server-side-rendered-spas-with-asp.net-and-no-javascript/ class=umami--click--related-side-server-side-rendered-spas-with-asp-net-and-no-javascript-><div class=article-details><h2 class=article-title>Server-side rendered SPAs with ASP.NET and no Javascript</h2><footer class=article-time><time datetime=2023-10-11T08:20:00-03:00>11 Oct 2023</time></footer></div><div class=article-image><img src=/p/server-side-rendered-spas-with-asp.net-and-no-javascript/cover.jpg width=800 height=528 alt="Server-side rendered SPAs with ASP.NET and no Javascript" loading=lazy></div></a></article><article><a href=/p/integration-tests-with-aws-s3-buckets-using-localstack-and-testcontainers/ class=umami--click--related-side-integration-tests-with-aws-s3-buckets-using-localstack-and-testcontainers-><div class=article-details><h2 class=article-title>Integration tests with AWS S3 buckets using Localstack and Testcontainers</h2><footer class=article-time><time datetime=2023-07-31T20:00:00-03:00>31 Jul 2023</time></footer></div><div class=article-image><img src=/p/integration-tests-with-aws-s3-buckets-using-localstack-and-testcontainers/cover.jpg width=800 height=458 alt="Integration tests with AWS S3 buckets using Localstack and Testcontainers" loading=lazy></div></a></article></div></section><section class="widget archives"><h2 class="widget-title section-title">Recent posts</h2><div class=article-list--mini><article><a href=/p/server-side-rendered-spas-with-asp.net-and-no-javascript/ class=umami--click--recentposts-server-side-rendered-spas-with-asp-net-and-no-javascript-><div class=article-details><h2 class=article-title>Server-side rendered SPAs with ASP.NET and no Javascript</h2><footer class=article-time><time datetime=2023-10-11T08:20:00-03:00>11 Oct 2023</time></footer></div><div class=article-image><img src=/p/server-side-rendered-spas-with-asp.net-and-no-javascript/cover.jpg width=800 height=528 alt="Server-side rendered SPAs with ASP.NET and no Javascript" loading=lazy></div></a></article><article><a href=/p/integration-tests-with-aws-s3-buckets-using-localstack-and-testcontainers/ class=umami--click--recentposts-integration-tests-with-aws-s3-buckets-using-localstack-and-testcontainers-><div class=article-details><h2 class=article-title>Integration tests with AWS S3 buckets using Localstack and Testcontainers</h2><footer class=article-time><time datetime=2023-07-31T20:00:00-03:00>31 Jul 2023</time></footer></div><div class=article-image><img src=/p/integration-tests-with-aws-s3-buckets-using-localstack-and-testcontainers/cover.jpg width=800 height=458 alt="Integration tests with AWS S3 buckets using Localstack and Testcontainers" loading=lazy></div></a></article><article><a href=/p/building-a-whos-that-pokemon-game-for-android-with-net-maui-and-blazor-hybrid/ class=umami--click--recentposts-building-a-whos-that-pokemon-game-for-android-with-net-maui-and-blazor-hybrid-><div class=article-details><h2 class=article-title>Building a Who's that Pok√©mon game for Android with .NET MAUI and Blazor Hybrid</h2><footer class=article-time><time datetime=2023-06-28T06:00:00-03:00>28 Jun 2023</time></footer></div><div class=article-image><img src=/p/building-a-whos-that-pokemon-game-for-android-with-net-maui-and-blazor-hybrid/cover.jpg width=800 height=500 alt="Building a Who's that Pok√©mon game for Android with .NET MAUI and Blazor Hybrid" loading=lazy></div></a></article><article><a href=/p/how-to-run-scripts-on-sql-server-container-startup/ class=umami--click--recentposts-how-to-run-scripts-on-sql-server-container-startup-><div class=article-details><h2 class=article-title>How to run scripts on SQL Server container startup</h2><footer class=article-time><time datetime=2023-05-15T06:00:00-03:00>15 May 2023</time></footer></div><div class=article-image><img src=/p/how-to-run-scripts-on-sql-server-container-startup/cover.jpg width=800 height=450 alt="How to run scripts on SQL Server container startup" loading=lazy></div></a></article><article><a href=/p/real-time-charts-with-blazor-signalr-and-apexcharts/ class=umami--click--recentposts-real-time-charts-with-blazor-signalr-and-apexcharts-><div class=article-details><h2 class=article-title>Real-time charts with Blazor, SignalR and ApexCharts</h2><footer class=article-time><time datetime=2023-05-02T06:00:00-03:00>02 May 2023</time></footer></div><div class=article-image><img src=/p/real-time-charts-with-blazor-signalr-and-apexcharts/cover.jpg width=1000 height=667 alt="Real-time charts with Blazor, SignalR and ApexCharts" loading=lazy></div></a></article></div></section></aside></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script><script src=https://storage.ko-fi.com/cdn/scripts/overlay-widget.js></script>
<script>kofiWidgetOverlay.draw("genezini",{type:"floating-chat","floating-chat.donateButton.text":"Support me","floating-chat.donateButton.background-color":"#d9534f","floating-chat.donateButton.text-color":"#fff"})</script></body></html>