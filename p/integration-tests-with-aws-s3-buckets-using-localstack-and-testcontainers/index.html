<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Testing AWS integrations with a local AWS emulator"><title>Integration tests with AWS S3 buckets using Localstack and Testcontainers</title><link rel=canonical href=https://blog.genezini.com/p/integration-tests-with-aws-s3-buckets-using-localstack-and-testcontainers/><link rel=alternate href=https://blog.genezini.com/ hreflang=x-default><link rel=stylesheet href=/scss/style.min.e3e9c075987ec9abe7be9200a4fe17175980754b0c822a22c3165916d315251e.css><meta property="og:title" content="Integration tests with AWS S3 buckets using Localstack and Testcontainers"><meta property="og:description" content="Testing AWS integrations with a local AWS emulator"><meta property="og:url" content="https://blog.genezini.com/p/integration-tests-with-aws-s3-buckets-using-localstack-and-testcontainers/"><meta property="og:site_name" content="Daniel Genezini | It works on my machine"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="C#"><meta property="article:tag" content="dotnet"><meta property="article:tag" content="AWS"><meta property="article:tag" content="Testcontainers"><meta property="article:tag" content="LocalStack"><meta property="article:tag" content="Docker"><meta property="article:tag" content="Containers"><meta property="article:tag" content="Tests"><meta property="article:tag" content="Automated Tests"><meta property="article:tag" content="Integration Tests"><meta property="article:published_time" content="2023-07-31T20:00:00-03:00"><meta property="article:modified_time" content="2023-07-31T20:00:00-03:00"><meta property="og:image" content="https://blog.genezini.com/p/integration-tests-with-aws-s3-buckets-using-localstack-and-testcontainers/cover.jpg"><meta name=twitter:title content="Integration tests with AWS S3 buckets using Localstack and Testcontainers"><meta name=twitter:description content="Testing AWS integrations with a local AWS emulator"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.genezini.com/p/integration-tests-with-aws-s3-buckets-using-localstack-and-testcontainers/cover.jpg"><script async src="https://www.googletagmanager.com/gtag/js?id=G-029SLZEC4C"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-029SLZEC4C",{anonymize_ip:!1})}</script><script async defer data-website-id=05387238-0856-4199-8d28-696e4a1d7322 src=https://sparkling-pixie-afead0.netlify.app/tomato.js></script></head><body class="article-page
//"><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><div class=site-meta><h1 class=site-name><a href=/>It works on my machine</a></h1></div><figure class=site-avatar><a href=/><img src=/img/avatar_hu793066471163999a4414bfb3be66f111_30130_300x0_resize_q75_box.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><span class=site-name>Daniel Genezini</span></header><ol class=social-menu><li><a class=umami--click--socialmenu-GitHub href=https://github.com/dgenezini/ target=_blank title=GitHub><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a class=umami--click--socialmenu-Linkedin href=https://www.linkedin.com/in/danielgenezini/ target=_blank title=Linkedin><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-linkedin" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><rect x="4" y="4" width="16" height="16" rx="2"/><line x1="8" y1="11" x2="8" y2="16"/><line x1="8" y1="8" x2="8" y2="8.01"/><line x1="12" y1="16" x2="12" y2="11"/><path d="M16 16v-3a2 2 0 00-4 0"/></svg></a></li><li><a class=umami--click--socialmenu-Mastodon href=https://mastodon.world/@danielgenezini target=_blank title=Mastodon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-mastodon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18.648 15.254C16.832 17.017 12 16.88 12 16.88a18.262 18.262.0 01-3.288-.256c1.127 1.985 4.12 2.81 8.982 2.475-1.945 2.013-13.598 5.257-13.668-7.636L4 10.309c0-3.036.023-4.115 1.352-5.633C7.023 2.766 12 3.01 12 3.01s4.977-.243 6.648 1.667C19.977 6.195 20 7.274 20 10.31s-.456 4.074-1.352 4.944z"/><path d="M12 11.204V8.278C12 7.02 11.105 6 10 6S8 7.02 8 8.278V13m4-4.722C12 7.02 12.895 6 14 6s2 1.02 2 2.278V13"/></svg></a></li><li><a class=umami--click--socialmenu-Twitter href=https://twitter.com/GeneziniDaniel target=_blank title=Twitter><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Archives</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>Search</span></a></li><li><a href=/follow-me/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-rss" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="5" cy="19" r="1"/><path d="M4 4a16 16 0 0116 16"/><path d="M4 11a9 9 0 019 9"/></svg><span>Follow me</span></a></li><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>Dark Mode</span></li></div></ol></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/p/integration-tests-with-aws-s3-buckets-using-localstack-and-testcontainers/><img src=/p/integration-tests-with-aws-s3-buckets-using-localstack-and-testcontainers/cover.jpg width=800 height=458 loading=lazy alt="Featured image of post Integration tests with AWS S3 buckets using Localstack and Testcontainers"></a></div><div class=picture-credits><a href=https://unsplash.com/photos/ccsM58blB9c target=_blank>Picture by Daiga Ellaby</a></div><div class=article-details><header class=article-category><a href=/categories/aws/ class=umami--click--categories-header--categories-aws->AWS</a>
<a href=/categories/dotnet/ class=umami--click--categories-header--categories-dotnet->.NET</a>
<a href=/categories/c-sharp/ class=umami--click--categories-header--categories-c-sharp->C#</a>
<a href=/categories/tests/ class=umami--click--categories-header--categories-tests->Tests</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/integration-tests-with-aws-s3-buckets-using-localstack-and-testcontainers/>Integration tests with AWS S3 buckets using Localstack and Testcontainers</a></h2><h3 class=article-subtitle>Testing AWS integrations with a local AWS emulator</h3></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>31 Jul 2023</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>10 minute read</time>
<a href=/follow-me/ aria-label="Follow me"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-rss" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="5" cy="19" r="1"/><path d="M4 4a16 16 0 0116 16"/><path d="M4 11a9 9 0 019 9"/></svg><span>Follow me</span></a>
<a data-pocket-label=pocket data-save-url=https://blog.genezini.com/p/integration-tests-with-aws-s3-buckets-using-localstack-and-testcontainers/ data-pocket-count=none class=pocket-btn data-lang=en></a>
<script type=text/javascript>!function(e,t){if(!e.getElementById(t)){var s,n=e.createElement("script");n.id=t,n.src="https://widgets.getpocket.com/v1/j/btn.js?v=1",s=e.getElementById(t),e.body.appendChild(n)}}(document,"pocket-btn-js")</script></div></footer></div></header><section class=article-content><div class=article-seriestitle>This post is part of a series:</div><div><article><div class=article-seriespost><a href=/p/dotnet-and-aws-s3-with-localstack-how-to-develop-with-local-s3-buckets/>Part &nbsp;1&nbsp;
- &nbsp;.NET and AWS S3 with LocalStack: How to develop with local S3 buckets</a></div></article><article><div class=article-seriespost>Part &nbsp;2&nbsp;
- &nbsp;Integration tests with AWS S3 buckets using Localstack and Testcontainers</div></article></div></section><section class=article-content><h2 id=introduction>Introduction <a href=#introduction class=header-link arialabel=Anchor><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Link to this section</title><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></a></h2><p>As I explained previously in <a class=link href=/p/integration-tests-without-api-dependencies-with-asp.net-core-and-wiremock.net/>this article</a>, in integration tests, we should mock unmanaged dependencies (dependencies that are external to our system and not controlled by us, like APIs) but test against real managed dependencies (dependencies that are controlled by our system, like databases, queues, etc). This improves the reliability of the integration tests because the communication with these dependencies are a complex part of the system and can break with a package update, a database update or a change in a queue message format.</p><p>In this post, I&rsquo;ll show how to use Localstack and Testcontainers to emulate an AWS environment for use in integration tests.</p><h2 id=why-use-localstack-for-integration-tests>Why use Localstack for integration tests? <a href=#why-use-localstack-for-integration-tests class=header-link arialabel=Anchor><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Link to this section</title><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></a></h2><ul><li>Reduced Costs: Using LocalStack eliminates the use of AWS resources during tests and development. It also avoids accidental charges during development, for example, in cases of incorrect logic;</li><li>Development speed: Using LocalStack allows developer to test without having to deploy or configure AWS credentials on the local environment. It also remove external factors, as other people using the same AWS resources on the environment;</li><li>Reproducibility and less flaky tests: Integration tests run in an isolated environment, avoiding any interference with the production or staging environment. This makes tests reproducible in any developer&rsquo;s machine and less flaky because there is no dependency with the network and a shared AWS environment, that can change frequently;</li><li>Cleanup: LocalStack environment is automatically cleaned up after the tests, making easier to use in automated tests;</li><li>Test of Edge Cases: We can customize LocalStack&rsquo;s configuration, allowing us to test edge cases that may not be tested on an AWS environment, like rate limits and permissions errors.</li></ul><h2 id=what-is-testcontainers>What is Testcontainers? <a href=#what-is-testcontainers class=header-link arialabel=Anchor><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Link to this section</title><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></a></h2><p>Testcontainers is a library that manages containers&rsquo; lifecycle to be used in automated tests. These containers are useful for testing applications against real managed dependencies, like databases, or AWS resources (using LocalStack) that can be created and disposed of after the tests.</p><h2 id=running-a-disposable-container-with-testcontainers>Running a disposable container with Testcontainers <a href=#running-a-disposable-container-with-testcontainers class=header-link arialabel=Anchor><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Link to this section</title><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></a></h2><p>To use Testcontainers, you will need to have a container runtime (<a class=link href=https://www.docker.com/products/docker-desktop/ target=_blank rel=noopener>Docker</a>, <a class=link href=https://podman-desktop.io/ target=_blank rel=noopener>Podman</a>, <a class=link href=https://www.rancher.com/products/rancher-desktop target=_blank rel=noopener>Rancher</a>, etc) installed on your machine.</p><p>Then, you need to add the Testcontainers NuGet package to your test project:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>dotnet add package Testcontainers
</span></span></code></pre></div><p>To run a LocalStack container, we first need to use the <code>ContainerBuilder</code> class to build an <code>IContainer</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=k>const</span> <span class=kt>int</span> <span class=n>LocalStackPort</span> <span class=p>=</span> <span class=m>4566</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=kt>string</span> <span class=n>LocalStackImage</span> <span class=p>=</span> <span class=s>&#34;localstack/localstack:1.3.1&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>await</span> <span class=k>using</span> <span class=nn>var</span> <span class=n>LocalStackTestcontainer</span> <span class=p>=</span> <span class=k>new</span> <span class=n>ContainerBuilder</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>WithImage</span><span class=p>(</span><span class=n>LocalStackImage</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>WithExposedPort</span><span class=p>(</span><span class=n>LocalStackPort</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>WithPortBinding</span><span class=p>(</span><span class=n>LocalStackPort</span><span class=p>,</span> <span class=k>true</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>WithWaitStrategy</span><span class=p>(</span><span class=n>Wait</span><span class=p>.</span><span class=n>ForUnixContainer</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=n>UntilHttpRequestIsSucceeded</span><span class=p>(</span><span class=n>request</span> <span class=p>=&gt;</span> <span class=n>request</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=n>ForPath</span><span class=p>(</span><span class=s>&#34;/_localstack/health&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=n>ForPort</span><span class=p>(</span><span class=n>LocalStackPort</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>Build</span><span class=p>();</span>
</span></span></code></pre></td></tr></table></div></div><p>Then, we start the container and use the <code>Hostname</code> property and <code>GetMappedPublicPort()</code> method to create the ServiceUrl that will be used by the AWS Clients:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=k>const</span> <span class=kt>int</span> <span class=n>LocalStackPort</span> <span class=p>=</span> <span class=m>4566</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=kt>string</span> <span class=n>LocalStackImage</span> <span class=p>=</span> <span class=s>&#34;localstack/localstack:1.3.1&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>await</span> <span class=k>using</span> <span class=nn>var</span> <span class=n>LocalStackTestcontainer</span> <span class=p>=</span> <span class=k>new</span> <span class=n>ContainerBuilder</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>WithImage</span><span class=p>(</span><span class=n>LocalStackImage</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>WithExposedPort</span><span class=p>(</span><span class=n>LocalStackPort</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>WithPortBinding</span><span class=p>(</span><span class=n>LocalStackPort</span><span class=p>,</span> <span class=k>true</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>WithWaitStrategy</span><span class=p>(</span><span class=n>Wait</span><span class=p>.</span><span class=n>ForUnixContainer</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=n>UntilHttpRequestIsSucceeded</span><span class=p>(</span><span class=n>request</span> <span class=p>=&gt;</span> <span class=n>request</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=n>ForPath</span><span class=p>(</span><span class=s>&#34;/_localstack/health&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=n>ForPort</span><span class=p>(</span><span class=n>LocalStackPort</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>Build</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>await</span> <span class=n>LocalStackTestcontainer</span><span class=p>.</span><span class=n>StartAsync</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>localstackUrl</span> <span class=p>=</span> <span class=s>$&#34;http://{_localStackTestcontainer.Hostname}:{_localStackTestcontainer.GetMappedPublicPort(4566)}&#34;</span><span class=p>;</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p>❗ The <code>IContainer</code> interface extends <code>IAsyncDisposable</code> and needs to be disposed of after use. We can use the <code>await using</code> syntax, as in the example above, or call the <code>DisposeAsync</code> method, as in the fixture shown below.</p></blockquote><h2 id=example-context>Example context <a href=#example-context class=header-link arialabel=Anchor><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Link to this section</title><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></a></h2><p>In the example from <a class=link href=/p/dotnet-and-aws-s3-with-localstack-how-to-develop-with-local-s3-buckets/>Part 1</a>, I have a controller with a <code>POST</code> method that uploads an image to an S3 bucket and a <code>GET</code> method that finds an image from the S3 bucket by its file name:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=n>app</span><span class=p>.</span><span class=n>MapPost</span><span class=p>(</span><span class=s>&#34;/upload&#34;</span><span class=p>,</span> <span class=k>async</span> <span class=p>(</span><span class=n>IAmazonS3</span> <span class=n>s3Client</span><span class=p>,</span> <span class=n>IFormFile</span> <span class=n>file</span><span class=p>)</span> <span class=p>=&gt;</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>var</span> <span class=n>bucketName</span> <span class=p>=</span> <span class=n>builder</span><span class=p>.</span><span class=n>Configuration</span><span class=p>[</span><span class=s>&#34;BucketName&#34;</span><span class=p>]!;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>var</span> <span class=n>bucketExists</span> <span class=p>=</span> <span class=k>await</span> <span class=n>s3Client</span><span class=p>.</span><span class=n>DoesS3BucketExistAsync</span><span class=p>(</span><span class=n>bucketName</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(!</span><span class=n>bucketExists</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>Results</span><span class=p>.</span><span class=n>BadRequest</span><span class=p>(</span><span class=s>$&#34;Bucket {bucketName} does not exists.&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>using</span> <span class=nn>var</span> <span class=n>fileStream</span> <span class=p>=</span> <span class=n>file</span><span class=p>.</span><span class=n>OpenReadStream</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>var</span> <span class=n>putObjectRequest</span> <span class=p>=</span> <span class=k>new</span> <span class=n>PutObjectRequest</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>BucketName</span> <span class=p>=</span> <span class=n>bucketName</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>Key</span> <span class=p>=</span> <span class=n>file</span><span class=p>.</span><span class=n>FileName</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>InputStream</span> <span class=p>=</span> <span class=n>fileStream</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>putObjectRequest</span><span class=p>.</span><span class=n>Metadata</span><span class=p>.</span><span class=n>Add</span><span class=p>(</span><span class=s>&#34;Content-Type&#34;</span><span class=p>,</span> <span class=n>file</span><span class=p>.</span><span class=n>ContentType</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>var</span> <span class=n>putResult</span> <span class=p>=</span> <span class=k>await</span> <span class=n>s3Client</span><span class=p>.</span><span class=n>PutObjectAsync</span><span class=p>(</span><span class=n>putObjectRequest</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>Results</span><span class=p>.</span><span class=n>Ok</span><span class=p>(</span><span class=s>$&#34;File {file.FileName} uploaded to S3 successfully!&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span><span class=p>.</span><span class=n>MapGet</span><span class=p>(</span><span class=s>&#34;/object/{key}&#34;</span><span class=p>,</span> <span class=k>async</span> <span class=p>(</span><span class=n>IAmazonS3</span> <span class=n>s3Client</span><span class=p>,</span> <span class=kt>string</span> <span class=n>key</span><span class=p>)</span> <span class=p>=&gt;</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>var</span> <span class=n>bucketName</span> <span class=p>=</span> <span class=n>builder</span><span class=p>.</span><span class=n>Configuration</span><span class=p>[</span><span class=s>&#34;BucketName&#34;</span><span class=p>]!;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>var</span> <span class=n>bucketExists</span> <span class=p>=</span> <span class=k>await</span> <span class=n>s3Client</span><span class=p>.</span><span class=n>DoesS3BucketExistAsync</span><span class=p>(</span><span class=n>bucketName</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(!</span><span class=n>bucketExists</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>Results</span><span class=p>.</span><span class=n>BadRequest</span><span class=p>(</span><span class=s>$&#34;Bucket {bucketName} does not exists.&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>try</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>var</span> <span class=n>getObjectResponse</span> <span class=p>=</span> <span class=k>await</span> <span class=n>s3Client</span><span class=p>.</span><span class=n>GetObjectAsync</span><span class=p>(</span><span class=n>bucketName</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>key</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>Results</span><span class=p>.</span><span class=n>File</span><span class=p>(</span><span class=n>getObjectResponse</span><span class=p>.</span><span class=n>ResponseStream</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>getObjectResponse</span><span class=p>.</span><span class=n>Headers</span><span class=p>.</span><span class=n>ContentType</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>catch</span> <span class=p>(</span><span class=n>AmazonS3Exception</span> <span class=n>ex</span><span class=p>)</span> <span class=n>when</span> <span class=p>(</span><span class=n>ex</span><span class=p>.</span><span class=n>ErrorCode</span><span class=p>.</span><span class=n>Equals</span><span class=p>(</span><span class=s>&#34;NotFound&#34;</span><span class=p>,</span> <span class=n>StringComparison</span><span class=p>.</span><span class=n>OrdinalIgnoreCase</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>Results</span><span class=p>.</span><span class=n>NotFound</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p>⚠️ The business logic in the controller is just for the sake of simplicity. In a real-world application, the logic should be in a Use Case/Interactor or something with the same purpose.</p></blockquote><h2 id=creating-integration-tests-with-testcontainers>Creating integration tests with Testcontainers <a href=#creating-integration-tests-with-testcontainers class=header-link arialabel=Anchor><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Link to this section</title><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></a></h2><p>In this example, I&rsquo;m using xUnit and the <code>WebApplicationFactory&lt;T></code> class from ASP.NET Core.</p><p>If you don&rsquo;t know how to use the <code>WebApplicationFactory&lt;T></code> class, I explained in <a class=link href=/p/integration-tests-without-api-dependencies-with-asp.net-core-and-wiremock.net/>this post</a>.</p><p>When running in AWS, the <code>AmazonS3Client</code> will get its access data from the IAM Role attached to the service running it. When running locally, it will get from the AWS CLI profile named <code>default</code> or from the settings we pass to it.</p><blockquote><p>ℹ️ <em>The default profile is read from the AWSCLI credentials file</em> (<code>%userprofile%\.aws\credentials</code> on Windows and <code>~/.aws/credentials</code> on Linux).</p></blockquote><p>In the code below, I&rsquo;m checking for a configuration section with the name <code>AWS</code>, that is not present in the production environment. If it&rsquo;s found, I set the <code>Region</code>, <code>ServiceURL</code> and <code>ForcePathStyle</code> properties of the <code>AmazonS3Config</code> and pass it to the creation of the <code>AmazonS3Client</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=n>builder</span><span class=p>.</span><span class=n>Services</span><span class=p>.</span><span class=n>AddSingleton</span><span class=p>&lt;</span><span class=n>IAmazonS3</span><span class=p>&gt;(</span><span class=n>sc</span> <span class=p>=&gt;</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>var</span> <span class=n>configuration</span> <span class=p>=</span> <span class=n>sc</span><span class=p>.</span><span class=n>GetRequiredService</span><span class=p>&lt;</span><span class=n>IConfiguration</span><span class=p>&gt;();</span>
</span></span><span class=line><span class=cl>    <span class=kt>var</span> <span class=n>awsConfiguration</span> <span class=p>=</span> <span class=n>configuration</span><span class=p>.</span><span class=n>GetSection</span><span class=p>(</span><span class=s>&#34;AWS&#34;</span><span class=p>).</span><span class=n>Get</span><span class=p>&lt;</span><span class=n>AwsConfiguration</span><span class=p>&gt;();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>awsConfiguration</span><span class=p>?.</span><span class=n>ServiceURL</span> <span class=k>is</span> <span class=k>null</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>new</span> <span class=n>AmazonS3Client</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>AwsS3ClientFactory</span><span class=p>.</span><span class=n>CreateAwsS3Client</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>awsConfiguration</span><span class=p>.</span><span class=n>ServiceURL</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>awsConfiguration</span><span class=p>.</span><span class=n>Region</span><span class=p>,</span> <span class=n>awsConfiguration</span><span class=p>.</span><span class=n>ForcePathStyle</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>awsConfiguration</span><span class=p>.</span><span class=n>AwsAccessKey</span><span class=p>,</span> <span class=n>awsConfiguration</span><span class=p>.</span><span class=n>AwsSecretKey</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><p>For the integration tests, those settings (except for the <code>ServiceURL</code>) will be configured in <code>appsettings.IntegrationTest.json</code> file, that is injected by the <code>WebApplicationFactory&lt;T></code> class:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=err>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;AWS&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;Region&#34;</span><span class=p>:</span> <span class=s2>&#34;us-east-1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;ForcePathStyle&#34;</span><span class=p>:</span> <span class=s2>&#34;true&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;AwsAccessKey&#34;</span><span class=p>:</span> <span class=s2>&#34;test&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;AwsSecretKey&#34;</span><span class=p>:</span> <span class=s2>&#34;test&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p>ℹ️ <strong>As the container will have a random public port</strong>, the <code>AWS:ServiceURL</code> configuration has to be passed after Testcontainers starts the LocalStack container, using the <code>Hostname</code> and <code>GetMappedPublicPort(4566)</code> to create the full URL.</p></blockquote><h2 id=localstacktestcontainer-fixture>LocalStack/Testcontainer Fixture <a href=#localstacktestcontainer-fixture class=header-link arialabel=Anchor><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Link to this section</title><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></a></h2><p>This fixture will start and dispose of the Localstack container, sharing it with all tests.</p><p>I recommend using the same container instance for all tests, instead of one per test. It will require more attention to avoid cause between the tests, but will save time in executing them.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=na>[CollectionDefinition(&#34;LocalStackTestcontainer Collection&#34;)]</span>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>class</span> <span class=nc>LocalStackTestcontainerCollection</span> <span class=p>:</span> 
</span></span><span class=line><span class=cl>    <span class=n>ICollectionFixture</span><span class=p>&lt;</span><span class=n>LocalStackTestcontainerFixture</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>class</span> <span class=nc>LocalStackTestcontainerFixture</span> <span class=p>:</span> <span class=n>IAsyncLifetime</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>const</span> <span class=kt>int</span> <span class=n>LocalStackPort</span> <span class=p>=</span> <span class=m>4566</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>const</span> <span class=kt>string</span> <span class=n>LocalStackImage</span> <span class=p>=</span> <span class=s>&#34;localstack/localstack:1.3.1&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=n>IContainer</span> <span class=n>LocalStackTestcontainer</span> <span class=p>{</span> <span class=k>get</span><span class=p>;</span> <span class=k>private</span> <span class=k>set</span><span class=p>;</span> <span class=p>}</span> <span class=p>=</span> <span class=k>default</span><span class=p>!;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>async</span> <span class=n>Task</span> <span class=n>InitializeAsync</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>LocalStackTestcontainer</span> <span class=p>=</span> <span class=k>new</span> <span class=n>ContainerBuilder</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=n>WithImage</span><span class=p>(</span><span class=n>LocalStackImage</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=n>WithExposedPort</span><span class=p>(</span><span class=n>LocalStackPort</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=n>WithPortBinding</span><span class=p>(</span><span class=n>LocalStackPort</span><span class=p>,</span> <span class=k>true</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=n>WithWaitStrategy</span><span class=p>(</span><span class=n>Wait</span><span class=p>.</span><span class=n>ForUnixContainer</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                <span class=p>.</span><span class=n>UntilHttpRequestIsSucceeded</span><span class=p>(</span><span class=n>request</span> <span class=p>=&gt;</span> <span class=n>request</span>
</span></span><span class=line><span class=cl>                    <span class=p>.</span><span class=n>ForPath</span><span class=p>(</span><span class=s>&#34;/_localstack/health&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=p>.</span><span class=n>ForPort</span><span class=p>(</span><span class=n>LocalStackPort</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=n>Build</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>await</span> <span class=n>LocalStackTestcontainer</span><span class=p>.</span><span class=n>StartAsync</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>async</span> <span class=n>Task</span> <span class=n>DisposeAsync</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>await</span> <span class=n>LocalStackTestcontainer</span><span class=p>.</span><span class=n>DisposeAsync</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=upload-an-image-test>Upload an image test <a href=#upload-an-image-test class=header-link arialabel=Anchor><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Link to this section</title><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></a></h2><p>The test reads the configurations with <code>IConfiguration</code> to create an <code>AmazonS3Client</code> and create the bucket in the LocalStack environment and to assert the test condition (the object was created in the bucket):</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=na>[Collection(&#34;LocalStackTestcontainer Collection&#34;)]</span>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>class</span> <span class=nc>UploadTests</span> <span class=p>:</span> <span class=n>IClassFixture</span><span class=p>&lt;</span><span class=n>CustomWebApplicationFactory</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=k>readonly</span> <span class=n>CustomWebApplicationFactory</span> <span class=n>_factory</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=k>readonly</span> <span class=n>IContainer</span> <span class=n>_localStackTestcontainer</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=n>UploadTests</span><span class=p>(</span><span class=n>CustomWebApplicationFactory</span> <span class=n>factory</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>LocalStackTestcontainerFixture</span> <span class=n>localStackTestcontainerFixture</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>_factory</span> <span class=p>=</span> <span class=n>factory</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>_localStackTestcontainer</span> <span class=p>=</span> <span class=n>localStackTestcontainerFixture</span><span class=p>.</span><span class=n>LocalStackTestcontainer</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=na>
</span></span></span><span class=line><span class=cl><span class=na>    [Fact]</span>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>async</span> <span class=n>Task</span> <span class=n>UploadObject_Returns200</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>//Arrange</span>
</span></span><span class=line><span class=cl>        <span class=kt>var</span> <span class=n>localstackUrl</span> <span class=p>=</span> <span class=s>$&#34;http://{_localStackTestcontainer.Hostname}:{_localStackTestcontainer.GetMappedPublicPort(4566)}&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kt>var</span> <span class=n>HttpClient</span> <span class=p>=</span> <span class=n>_factory</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=n>WithWebHostBuilder</span><span class=p>(</span><span class=n>builder</span> <span class=p>=&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>builder</span><span class=p>.</span><span class=n>UseSetting</span><span class=p>(</span><span class=s>&#34;AWS:ServiceURL&#34;</span><span class=p>,</span> <span class=n>localstackUrl</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>})</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=n>CreateClient</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kt>var</span> <span class=n>configuration</span> <span class=p>=</span> <span class=n>_factory</span><span class=p>.</span><span class=n>Services</span><span class=p>.</span><span class=n>GetRequiredService</span><span class=p>&lt;</span><span class=n>IConfiguration</span><span class=p>&gt;();</span>
</span></span><span class=line><span class=cl>        <span class=kt>var</span> <span class=n>awsConfiguration</span> <span class=p>=</span> <span class=n>configuration</span><span class=p>.</span><span class=n>GetSection</span><span class=p>(</span><span class=s>&#34;AWS&#34;</span><span class=p>).</span><span class=n>Get</span><span class=p>&lt;</span><span class=n>AwsConfiguration</span><span class=p>&gt;()!;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kt>var</span> <span class=n>s3Client</span> <span class=p>=</span> <span class=n>AwsS3ClientFactory</span><span class=p>.</span><span class=n>CreateAwsS3Client</span><span class=p>(</span><span class=n>localstackUrl</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>            <span class=n>awsConfiguration</span><span class=p>.</span><span class=n>Region</span><span class=p>,</span> <span class=n>awsConfiguration</span><span class=p>.</span><span class=n>ForcePathStyle</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>awsConfiguration</span><span class=p>.</span><span class=n>AwsAccessKey</span><span class=p>,</span> <span class=n>awsConfiguration</span><span class=p>.</span><span class=n>AwsSecretKey</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>await</span> <span class=n>s3Client</span><span class=p>.</span><span class=n>PutBucketAsync</span><span class=p>(</span><span class=n>configuration</span><span class=p>[</span><span class=s>&#34;BucketName&#34;</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>const</span> <span class=kt>string</span> <span class=n>fileName</span> <span class=p>=</span> <span class=s>&#34;upload.jpg&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kt>var</span> <span class=n>filePath</span> <span class=p>=</span> <span class=n>Path</span><span class=p>.</span><span class=n>Combine</span><span class=p>(</span><span class=n>Directory</span><span class=p>.</span><span class=n>GetCurrentDirectory</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=s>&#34;Assets&#34;</span><span class=p>,</span> <span class=n>fileName</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>//Act</span>
</span></span><span class=line><span class=cl>        <span class=k>using</span> <span class=nn>var</span> <span class=n>multipartFormContent</span> <span class=p>=</span> <span class=k>new</span> <span class=n>MultipartFormDataContent</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kt>var</span> <span class=n>fileStreamContent</span> <span class=p>=</span> <span class=k>new</span> <span class=n>StreamContent</span><span class=p>(</span><span class=n>File</span><span class=p>.</span><span class=n>OpenRead</span><span class=p>(</span><span class=n>filePath</span><span class=p>));</span>
</span></span><span class=line><span class=cl>        <span class=n>fileStreamContent</span><span class=p>.</span><span class=n>Headers</span><span class=p>.</span><span class=n>ContentType</span> <span class=p>=</span> <span class=k>new</span> <span class=n>MediaTypeHeaderValue</span><span class=p>(</span><span class=s>&#34;image/jpg&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>multipartFormContent</span><span class=p>.</span><span class=n>Add</span><span class=p>(</span><span class=n>fileStreamContent</span><span class=p>,</span> <span class=n>name</span><span class=p>:</span> <span class=s>&#34;file&#34;</span><span class=p>,</span> <span class=n>fileName</span><span class=p>:</span> <span class=n>fileName</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kt>var</span> <span class=n>httpResponse</span> <span class=p>=</span> <span class=k>await</span> <span class=n>HttpClient</span><span class=p>.</span><span class=n>PostAsync</span><span class=p>(</span><span class=s>$&#34;/upload&#34;</span><span class=p>,</span> <span class=n>multipartFormContent</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>//Assert</span>
</span></span><span class=line><span class=cl>        <span class=n>httpResponse</span><span class=p>.</span><span class=n>StatusCode</span><span class=p>.</span><span class=n>Should</span><span class=p>().</span><span class=n>Be</span><span class=p>(</span><span class=n>HttpStatusCode</span><span class=p>.</span><span class=n>OK</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kt>var</span> <span class=n>bucketFile</span> <span class=p>=</span> <span class=k>await</span> <span class=n>s3Client</span><span class=p>.</span><span class=n>GetObjectAsync</span><span class=p>(</span><span class=n>configuration</span><span class=p>[</span><span class=s>&#34;BucketName&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>fileName</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>bucketFile</span><span class=p>.</span><span class=n>HttpStatusCode</span><span class=p>.</span><span class=n>Should</span><span class=p>().</span><span class=n>Be</span><span class=p>(</span><span class=n>HttpStatusCode</span><span class=p>.</span><span class=n>OK</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p>ℹ️ We could also create the S3 bucket using the <code>ExecAsync</code> method from Testcontainer&rsquo;s <code>IContainer</code> to execute AWS CLI commands in the Localstack container, but I find it easier and less error prone to do it with the AWS SDK.</p></blockquote><h2 id=upload-an-existing-image-test>Upload an existing image test <a href=#upload-an-existing-image-test class=header-link arialabel=Anchor><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Link to this section</title><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></a></h2><p>This test uses the <code>ListObjectsAsync</code> method of the <code>AmazonS3Client</code> to assert that uploading an image with the same file name will override the image instead of creating another:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=na>[Fact]</span>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>async</span> <span class=n>Task</span> <span class=n>UploadExistentObject_Returns200AndOverride</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>//Arrange</span>
</span></span><span class=line><span class=cl>    <span class=kt>var</span> <span class=n>localstackUrl</span> <span class=p>=</span> <span class=s>$&#34;http://{_localStackTestcontainer.Hostname}:{_localStackTestcontainer.GetMappedPublicPort(4566)}&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>var</span> <span class=n>HttpClient</span> <span class=p>=</span> <span class=n>_factory</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=n>WithWebHostBuilder</span><span class=p>(</span><span class=n>builder</span> <span class=p>=&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>builder</span><span class=p>.</span><span class=n>UseSetting</span><span class=p>(</span><span class=s>&#34;AWS:ServiceURL&#34;</span><span class=p>,</span> <span class=n>localstackUrl</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>})</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=n>CreateClient</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>var</span> <span class=n>configuration</span> <span class=p>=</span> <span class=n>_factory</span><span class=p>.</span><span class=n>Services</span><span class=p>.</span><span class=n>GetRequiredService</span><span class=p>&lt;</span><span class=n>IConfiguration</span><span class=p>&gt;();</span>
</span></span><span class=line><span class=cl>    <span class=kt>var</span> <span class=n>awsConfiguration</span> <span class=p>=</span> <span class=n>configuration</span><span class=p>.</span><span class=n>GetSection</span><span class=p>(</span><span class=s>&#34;AWS&#34;</span><span class=p>).</span><span class=n>Get</span><span class=p>&lt;</span><span class=n>AwsConfiguration</span><span class=p>&gt;()!;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>var</span> <span class=n>s3Client</span> <span class=p>=</span> <span class=n>AwsS3ClientFactory</span><span class=p>.</span><span class=n>CreateAwsS3Client</span><span class=p>(</span><span class=n>localstackUrl</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>awsConfiguration</span><span class=p>.</span><span class=n>Region</span><span class=p>,</span> <span class=n>awsConfiguration</span><span class=p>.</span><span class=n>ForcePathStyle</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>awsConfiguration</span><span class=p>.</span><span class=n>AwsAccessKey</span><span class=p>,</span> <span class=n>awsConfiguration</span><span class=p>.</span><span class=n>AwsSecretKey</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>await</span> <span class=n>s3Client</span><span class=p>.</span><span class=n>PutBucketAsync</span><span class=p>(</span><span class=n>configuration</span><span class=p>[</span><span class=s>&#34;BucketName&#34;</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>const</span> <span class=kt>string</span> <span class=n>fileName</span> <span class=p>=</span> <span class=s>&#34;upload.jpg&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>var</span> <span class=n>filePath</span> <span class=p>=</span> <span class=n>Path</span><span class=p>.</span><span class=n>Combine</span><span class=p>(</span><span class=n>Directory</span><span class=p>.</span><span class=n>GetCurrentDirectory</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>        <span class=s>&#34;Assets&#34;</span><span class=p>,</span> <span class=n>fileName</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>//Act</span>
</span></span><span class=line><span class=cl>    <span class=k>using</span> <span class=nn>var</span> <span class=n>multipartFormContent</span> <span class=p>=</span> <span class=k>new</span> <span class=n>MultipartFormDataContent</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>var</span> <span class=n>fileStreamContent</span> <span class=p>=</span> <span class=k>new</span> <span class=n>StreamContent</span><span class=p>(</span><span class=n>File</span><span class=p>.</span><span class=n>OpenRead</span><span class=p>(</span><span class=n>filePath</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=n>fileStreamContent</span><span class=p>.</span><span class=n>Headers</span><span class=p>.</span><span class=n>ContentType</span> <span class=p>=</span> <span class=k>new</span> <span class=n>MediaTypeHeaderValue</span><span class=p>(</span><span class=s>&#34;image/jpg&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>multipartFormContent</span><span class=p>.</span><span class=n>Add</span><span class=p>(</span><span class=n>fileStreamContent</span><span class=p>,</span> <span class=n>name</span><span class=p>:</span> <span class=s>&#34;file&#34;</span><span class=p>,</span> <span class=n>fileName</span><span class=p>:</span> <span class=n>fileName</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>var</span> <span class=n>httpResponse1</span> <span class=p>=</span> <span class=k>await</span> <span class=n>HttpClient</span><span class=p>.</span><span class=n>PostAsync</span><span class=p>(</span><span class=s>$&#34;/upload&#34;</span><span class=p>,</span> <span class=n>multipartFormContent</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>var</span> <span class=n>httpResponse2</span> <span class=p>=</span> <span class=k>await</span> <span class=n>HttpClient</span><span class=p>.</span><span class=n>PostAsync</span><span class=p>(</span><span class=s>$&#34;/upload&#34;</span><span class=p>,</span> <span class=n>multipartFormContent</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>//Assert</span>
</span></span><span class=line><span class=cl>    <span class=n>httpResponse1</span><span class=p>.</span><span class=n>StatusCode</span><span class=p>.</span><span class=n>Should</span><span class=p>().</span><span class=n>Be</span><span class=p>(</span><span class=n>HttpStatusCode</span><span class=p>.</span><span class=n>OK</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>httpResponse2</span><span class=p>.</span><span class=n>StatusCode</span><span class=p>.</span><span class=n>Should</span><span class=p>().</span><span class=n>Be</span><span class=p>(</span><span class=n>HttpStatusCode</span><span class=p>.</span><span class=n>OK</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>var</span> <span class=n>bucketObjects</span> <span class=p>=</span> <span class=k>await</span> <span class=n>s3Client</span><span class=p>.</span><span class=n>ListObjectsAsync</span><span class=p>(</span><span class=n>configuration</span><span class=p>[</span><span class=s>&#34;BucketName&#34;</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>bucketObjects</span><span class=p>.</span><span class=n>S3Objects</span><span class=p>.</span><span class=n>Count</span><span class=p>.</span><span class=n>Should</span><span class=p>().</span><span class=n>Be</span><span class=p>(</span><span class=m>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>var</span> <span class=n>bucketFile</span> <span class=p>=</span> <span class=k>await</span> <span class=n>s3Client</span><span class=p>.</span><span class=n>GetObjectAsync</span><span class=p>(</span><span class=n>configuration</span><span class=p>[</span><span class=s>&#34;BucketName&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=n>fileName</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>bucketFile</span><span class=p>.</span><span class=n>HttpStatusCode</span><span class=p>.</span><span class=n>Should</span><span class=p>().</span><span class=n>Be</span><span class=p>(</span><span class=n>HttpStatusCode</span><span class=p>.</span><span class=n>OK</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=get-an-image-test>Get an image test <a href=#get-an-image-test class=header-link arialabel=Anchor><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Link to this section</title><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></a></h2><p>To test the endpoint that returns the image, I use the <code>AmazonS3Client</code> to create the bucket and upload an image, and then, call the endpoint and assert that it returns the image:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=na>[Collection(&#34;LocalStackTestcontainer Collection&#34;)]</span>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>class</span> <span class=nc>GetObjectTests</span> <span class=p>:</span> <span class=n>IClassFixture</span><span class=p>&lt;</span><span class=n>CustomWebApplicationFactory</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=k>readonly</span> <span class=n>CustomWebApplicationFactory</span> <span class=n>_factory</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=k>readonly</span> <span class=n>IContainer</span> <span class=n>_localStackTestcontainer</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=n>GetObjectTests</span><span class=p>(</span><span class=n>CustomWebApplicationFactory</span> <span class=n>factory</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>LocalStackTestcontainerFixture</span> <span class=n>localStackTestcontainerFixture</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>_factory</span> <span class=p>=</span> <span class=n>factory</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>_localStackTestcontainer</span> <span class=p>=</span> <span class=n>localStackTestcontainerFixture</span><span class=p>.</span><span class=n>LocalStackTestcontainer</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=na>
</span></span></span><span class=line><span class=cl><span class=na>    [Fact]</span>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>async</span> <span class=n>Task</span> <span class=n>GetExistingObject_Returns200</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>//Arrange</span>
</span></span><span class=line><span class=cl>        <span class=kt>var</span> <span class=n>localstackUrl</span> <span class=p>=</span> <span class=s>$&#34;http://{_localStackTestcontainer.Hostname}:{_localStackTestcontainer.GetMappedPublicPort(4566)}&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kt>var</span> <span class=n>HttpClient</span> <span class=p>=</span> <span class=n>_factory</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=n>WithWebHostBuilder</span><span class=p>(</span><span class=n>builder</span> <span class=p>=&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>builder</span><span class=p>.</span><span class=n>UseSetting</span><span class=p>(</span><span class=s>&#34;AWS:ServiceURL&#34;</span><span class=p>,</span> <span class=n>localstackUrl</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>})</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=n>CreateClient</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kt>var</span> <span class=n>configuration</span> <span class=p>=</span> <span class=n>_factory</span><span class=p>.</span><span class=n>Services</span><span class=p>.</span><span class=n>GetRequiredService</span><span class=p>&lt;</span><span class=n>IConfiguration</span><span class=p>&gt;();</span>
</span></span><span class=line><span class=cl>        <span class=kt>var</span> <span class=n>awsConfiguration</span> <span class=p>=</span> <span class=n>configuration</span><span class=p>.</span><span class=n>GetSection</span><span class=p>(</span><span class=s>&#34;AWS&#34;</span><span class=p>).</span><span class=n>Get</span><span class=p>&lt;</span><span class=n>AwsConfiguration</span><span class=p>&gt;()!;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kt>var</span> <span class=n>s3Client</span> <span class=p>=</span> <span class=n>AwsS3ClientFactory</span><span class=p>.</span><span class=n>CreateAwsS3Client</span><span class=p>(</span><span class=n>localstackUrl</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>awsConfiguration</span><span class=p>.</span><span class=n>Region</span><span class=p>,</span> <span class=n>awsConfiguration</span><span class=p>.</span><span class=n>ForcePathStyle</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>awsConfiguration</span><span class=p>.</span><span class=n>AwsAccessKey</span><span class=p>,</span> <span class=n>awsConfiguration</span><span class=p>.</span><span class=n>AwsSecretKey</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>await</span> <span class=n>s3Client</span><span class=p>.</span><span class=n>PutBucketAsync</span><span class=p>(</span><span class=n>configuration</span><span class=p>[</span><span class=s>&#34;BucketName&#34;</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>const</span> <span class=kt>string</span> <span class=n>fileName</span> <span class=p>=</span> <span class=s>&#34;upload.jpg&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kt>var</span> <span class=n>filePath</span> <span class=p>=</span> <span class=n>Path</span><span class=p>.</span><span class=n>Combine</span><span class=p>(</span><span class=n>Directory</span><span class=p>.</span><span class=n>GetCurrentDirectory</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=s>&#34;Assets&#34;</span><span class=p>,</span> <span class=n>fileName</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kt>var</span> <span class=n>putObjectRequest</span> <span class=p>=</span> <span class=k>new</span> <span class=n>PutObjectRequest</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>BucketName</span> <span class=p>=</span> <span class=n>configuration</span><span class=p>[</span><span class=s>&#34;BucketName&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>Key</span> <span class=p>=</span> <span class=n>fileName</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>FilePath</span> <span class=p>=</span> <span class=n>filePath</span>
</span></span><span class=line><span class=cl>        <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>putObjectRequest</span><span class=p>.</span><span class=n>Metadata</span><span class=p>.</span><span class=n>Add</span><span class=p>(</span><span class=s>&#34;Content-Type&#34;</span><span class=p>,</span> <span class=s>&#34;image/jpg&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kt>var</span> <span class=n>putResult</span> <span class=p>=</span> <span class=k>await</span> <span class=n>s3Client</span><span class=p>.</span><span class=n>PutObjectAsync</span><span class=p>(</span><span class=n>putObjectRequest</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>//Act</span>
</span></span><span class=line><span class=cl>        <span class=kt>var</span> <span class=n>httpResponse</span> <span class=p>=</span> <span class=k>await</span> <span class=n>HttpClient</span><span class=p>.</span><span class=n>GetAsync</span><span class=p>(</span><span class=s>$&#34;/object/{fileName}&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>//Assert</span>
</span></span><span class=line><span class=cl>        <span class=n>httpResponse</span><span class=p>.</span><span class=n>StatusCode</span><span class=p>.</span><span class=n>Should</span><span class=p>().</span><span class=n>Be</span><span class=p>(</span><span class=n>HttpStatusCode</span><span class=p>.</span><span class=n>OK</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>httpResponse</span><span class=p>.</span><span class=n>Content</span><span class=p>.</span><span class=n>Headers</span><span class=p>.</span><span class=n>ContentType</span><span class=p>.</span><span class=n>Should</span><span class=p>().</span><span class=n>Be</span><span class=p>(</span><span class=n>MediaTypeHeaderValue</span><span class=p>.</span><span class=n>Parse</span><span class=p>(</span><span class=s>&#34;image/jpeg&#34;</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=image-not-found-test>Image not found test <a href=#image-not-found-test class=header-link arialabel=Anchor><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Link to this section</title><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></a></h2><p>To test the behavior when the image doesn&rsquo;t exist, I use the <code>AmazonS3Client</code> to create the bucket, and then, call the endpoint that returns the image with a file name that doesn&rsquo;t exist in the bucket:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=na>[Fact]</span>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>async</span> <span class=n>Task</span> <span class=n>GetInexistingObject_Returns404</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>//Arrange</span>
</span></span><span class=line><span class=cl>    <span class=kt>var</span> <span class=n>localstackUrl</span> <span class=p>=</span> <span class=s>$&#34;http://{_localStackTestcontainer.Hostname}:{_localStackTestcontainer.GetMappedPublicPort(4566)}&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>var</span> <span class=n>HttpClient</span> <span class=p>=</span> <span class=n>_factory</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=n>WithWebHostBuilder</span><span class=p>(</span><span class=n>builder</span> <span class=p>=&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>builder</span><span class=p>.</span><span class=n>UseSetting</span><span class=p>(</span><span class=s>&#34;AWS:ServiceURL&#34;</span><span class=p>,</span> <span class=n>localstackUrl</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>})</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=n>CreateClient</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>var</span> <span class=n>configuration</span> <span class=p>=</span> <span class=n>_factory</span><span class=p>.</span><span class=n>Services</span><span class=p>.</span><span class=n>GetRequiredService</span><span class=p>&lt;</span><span class=n>IConfiguration</span><span class=p>&gt;();</span>
</span></span><span class=line><span class=cl>    <span class=kt>var</span> <span class=n>awsConfiguration</span> <span class=p>=</span> <span class=n>configuration</span><span class=p>.</span><span class=n>GetSection</span><span class=p>(</span><span class=s>&#34;AWS&#34;</span><span class=p>).</span><span class=n>Get</span><span class=p>&lt;</span><span class=n>AwsConfiguration</span><span class=p>&gt;()!;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>var</span> <span class=n>s3Client</span> <span class=p>=</span> <span class=n>AwsS3ClientFactory</span><span class=p>.</span><span class=n>CreateAwsS3Client</span><span class=p>(</span><span class=n>localstackUrl</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>awsConfiguration</span><span class=p>.</span><span class=n>Region</span><span class=p>,</span> <span class=n>awsConfiguration</span><span class=p>.</span><span class=n>ForcePathStyle</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>awsConfiguration</span><span class=p>.</span><span class=n>AwsAccessKey</span><span class=p>,</span> <span class=n>awsConfiguration</span><span class=p>.</span><span class=n>AwsSecretKey</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>await</span> <span class=n>s3Client</span><span class=p>.</span><span class=n>PutBucketAsync</span><span class=p>(</span><span class=n>configuration</span><span class=p>[</span><span class=s>&#34;BucketName&#34;</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>const</span> <span class=kt>string</span> <span class=n>fileName</span> <span class=p>=</span> <span class=s>&#34;inexisting.jpg&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>//Act</span>
</span></span><span class=line><span class=cl>    <span class=kt>var</span> <span class=n>httpResponse</span> <span class=p>=</span> <span class=k>await</span> <span class=n>HttpClient</span><span class=p>.</span><span class=n>GetAsync</span><span class=p>(</span><span class=s>$&#34;/object/{fileName}&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>//Assert</span>
</span></span><span class=line><span class=cl>    <span class=n>httpResponse</span><span class=p>.</span><span class=n>StatusCode</span><span class=p>.</span><span class=n>Should</span><span class=p>().</span><span class=n>Be</span><span class=p>(</span><span class=n>HttpStatusCode</span><span class=p>.</span><span class=n>NotFound</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=full-source-code>Full source code <a href=#full-source-code class=header-link arialabel=Anchor><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Link to this section</title><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></a></h2><p><a class=link href=https://github.com/dgenezini/UploadImageToS3LocalStack target=_blank rel=noopener>GitHub repository</a></p><h2 id=references-and-links>References and Links <a href=#references-and-links class=header-link arialabel=Anchor><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Link to this section</title><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></a></h2><ul><li><a class=link href=https://localstack.cloud/ target=_blank rel=noopener>LocalStack Website</a></li><li><a class=link href=https://docs.localstack.cloud/user-guide/aws/feature-coverage/ target=_blank rel=noopener>LocalStack Feature Coverage</a></li><li><a class=link href=https://dotnet.testcontainers.org/ target=_blank rel=noopener>Testcontainers</a></li></ul></section><footer class=article-footer><style>.comment-content{margin:var(--card-padding)0;color:var(--card-text-color-main);font-family:var(--article-font-family);font-size:calc(var(--article-font-size) * 1.1);line-height:var(--article-line-height)}</style><span class=comment-content>💬 Like or have something to add? <a href=#comments>Leave a comment below</a>.</span><style>.resp-sharing-button__link,.resp-sharing-button__icon{display:inline-block}.resp-sharing-button__link{text-decoration:none;color:#fff;margin:0 .5em .5em 0}.resp-sharing-button{border-radius:5px;transition:25ms ease-out;padding:.5em .75em;font-family:Helvetica Neue,Helvetica,Arial,sans-serif}.resp-sharing-button__icon svg{width:1em;height:1em;margin-right:.4em;vertical-align:top}.resp-sharing-button--small svg{margin:0;vertical-align:middle}.resp-sharing-button__icon{stroke:#fff;fill:none}.resp-sharing-button__icon--solid,.resp-sharing-button__icon--solidcircle{fill:#fff;stroke:none}.resp-sharing-button--twitter{background-color:#55acee}.resp-sharing-button--twitter:hover{background-color:#2795e9}.resp-sharing-button--pinterest{background-color:#bd081c}.resp-sharing-button--pinterest:hover{background-color:#8c0615}.resp-sharing-button--facebook{background-color:#3b5998}.resp-sharing-button--facebook:hover{background-color:#2d4373}.resp-sharing-button--tumblr{background-color:#35465c}.resp-sharing-button--tumblr:hover{background-color:#222d3c}.resp-sharing-button--reddit{background-color:#ff4500}.resp-sharing-button--reddit:hover{background-color:#d43b03}.resp-sharing-button--google{background-color:#dd4b39}.resp-sharing-button--google:hover{background-color:#c23321}.resp-sharing-button--linkedin{background-color:#0077b5}.resp-sharing-button--linkedin:hover{background-color:#046293}.resp-sharing-button--email{background-color:#777}.resp-sharing-button--email:hover{background-color:#5e5e5e}.resp-sharing-button--xing{background-color:#1a7576}.resp-sharing-button--xing:hover{background-color:#114c4c}.resp-sharing-button--whatsapp{background-color:#25d366}.resp-sharing-button--whatsapp:hover{background-color:#1da851}.resp-sharing-button--hackernews{background-color:#f60}.resp-sharing-button--hackernews:hover,.resp-sharing-button--hackernews:focus{background-color:#fb6200}.resp-sharing-button--vk{background-color:#507299}.resp-sharing-button--vk:hover{background-color:#43648c}.resp-sharing-button--facebook{background-color:#3b5998;border-color:#3b5998}.resp-sharing-button--facebook:hover,.resp-sharing-button--facebook:active{background-color:#2d4373;border-color:#2d4373}.resp-sharing-button--twitter{background-color:#55acee;border-color:#55acee}.resp-sharing-button--twitter:hover,.resp-sharing-button--twitter:active{background-color:#2795e9;border-color:#2795e9}.resp-sharing-button--tumblr{background-color:#35465c;border-color:#35465c}.resp-sharing-button--tumblr:hover,.resp-sharing-button--tumblr:active{background-color:#222d3c;border-color:#222d3c}.resp-sharing-button--email{background-color:#777;border-color:#777}.resp-sharing-button--email:hover,.resp-sharing-button--email:active{background-color:#5e5e5e;border-color:#5e5e5e}.resp-sharing-button--pinterest{background-color:#bd081c;border-color:#bd081c}.resp-sharing-button--pinterest:hover,.resp-sharing-button--pinterest:active{background-color:#8c0615;border-color:#8c0615}.resp-sharing-button--linkedin{background-color:#0077b5;border-color:#0077b5}.resp-sharing-button--linkedin:hover,.resp-sharing-button--linkedin:active{background-color:#046293;border-color:#046293}.resp-sharing-button--reddit{background-color:#ff4500;border-color:#bb3200}.resp-sharing-button--reddit:hover,.resp-sharing-button--reddit:active{background-color:#d43b03;border-color:#bb3200}.resp-sharing-button--feedly{background-color:#2bb24c}.resp-sharing-button--feedly:hover{background-color:#249440}.resp-sharing-button--feedly{background-color:#2bb24c;border-color:#2bb24c}.resp-sharing-button--feedly:hover,.resp-sharing-button--feedly:active{background-color:#249440;border-color:#249440}.resp-sharing-button--rss{background-color:#f26522}.resp-sharing-button--rss:hover{background-color:#cc541d}.resp-sharing-button--rss{background-color:#f26522;border-color:#f26522}.resp-sharing-button--rss:hover,.resp-sharing-button--rss:active{background-color:#cc541d;border-color:#cc541d}.resp-sharing-button--mastodon{background-color:#6364ff}.resp-sharing-button--mastodon:hover{background-color:#4646cc}.resp-sharing-button--mastodon{background-color:#6364ff;border-color:#6364ff}.resp-sharing-button--mastodon:hover,.resp-sharing-button--mastodon:active{background-color:#4646cc;border-color:#4646cc}.share-on-title{display:block;font-size:1.5em;margin-block-start:.83em;margin-block-end:.83em;margin-inline-start:0;margin-inline-end:0;font-weight:700;color:var(--card-text-color-main)}</style><span class=share-on-title>Follow me</span><div><a class="resp-sharing-button__link umami--click--follow-feedly" href=https://feedly.com/i/subscription/feed/https://blog.genezini.com/index.xml target=_blank value=Subscribe aria-label=Subscribe><div class="resp-sharing-button resp-sharing-button--feedly resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-rss" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="5" cy="19" r="1"/><path d="M4 4a16 16 0 0116 16"/><path d="M4 11a9 9 0 019 9"/></svg></div>Feedly</div></a><a class="resp-sharing-button__link umami--click--follow-rss" href=/index.xml target=_blank value=Subscribe aria-label=Subscribe><div class="resp-sharing-button resp-sharing-button--rss resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-rss" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="5" cy="19" r="1"/><path d="M4 4a16 16 0 0116 16"/><path d="M4 11a9 9 0 019 9"/></svg></div>RSS</div></a><a class="resp-sharing-button__link umami--click--follow-twitter" href=https://twitter.com/GeneziniDaniel target=_blank rel=noopener aria-label=Twitter><div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M23.44 4.83c-.8.37-1.5.38-2.22.02.93-.56.98-.96 1.32-2.02-.88.52-1.86.9-2.9 1.1-.82-.88-2-1.43-3.3-1.43-2.5.0-4.55 2.04-4.55 4.54.0.36.03.7.1 1.04-3.77-.2-7.12-2-9.36-4.75-.4.67-.6 1.45-.6 2.3.0 1.56.8 2.95 2 3.77-.74-.03-1.44-.23-2.05-.57v.06c0 2.2 1.56 4.03 3.64 4.44-.67.2-1.37.2-2.06.08.58 1.8 2.26 3.12 4.25 3.16C5.78 18.1 3.37 18.74 1 18.46c2 1.3 4.4 2.04 6.97 2.04 8.35.0 12.92-6.92 12.92-12.93.0-.2.0-.4-.02-.6.9-.63 1.96-1.22 2.56-2.14z"/></svg></div>Twitter</div></a><a class="resp-sharing-button__link umami--click--follow-linkedin" href=https://www.linkedin.com/in/danielgenezini/ target=_blank rel=noopener aria-label=LinkedIn><div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6.5 21.5h-5v-13h5v13zM4 6.5C2.5 6.5 1.5 5.3 1.5 4s1-2.4 2.5-2.4c1.6.0 2.5 1 2.6 2.5.0 1.4-1 2.5-2.6 2.5zm11.5 6c-1 0-2 1-2 2v7h-5v-13h5V10s1.6-1.5 4-1.5c3 0 5 2.2 5 6.3v6.7h-5v-7c0-1-1-2-2-2z"/></svg></div>LinkedIn</div></a><a class="resp-sharing-button__link umami--click--follow-mastodon" href=https://mastodon.world/@danielgenezini target=_blank rel=noopener aria-label=Mastodon><div class="resp-sharing-button resp-sharing-button--mastodon resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-mastodon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18.648 15.254C16.832 17.017 12 16.88 12 16.88a18.262 18.262.0 01-3.288-.256c1.127 1.985 4.12 2.81 8.982 2.475-1.945 2.013-13.598 5.257-13.668-7.636L4 10.309c0-3.036.023-4.115 1.352-5.633C7.023 2.766 12 3.01 12 3.01s4.977-.243 6.648 1.667C19.977 6.195 20 7.274 20 10.31s-.456 4.074-1.352 4.944z"/><path d="M12 11.204V8.278C12 7.02 11.105 6 10 6S8 7.02 8 8.278V13m4-4.722C12 7.02 12.895 6 14 6s2 1.02 2 2.278V13"/></svg></div>Mastodon</div></a></div><style>.resp-subscribe-button__link,.resp-subscribe-button__icon{display:inline-block}.resp-subscribe-button__link{text-decoration:none;color:#fff;margin:0 .5em .5em 0}.resp-subscribe-button{border-radius:5px;transition:25ms ease-out;padding:.5em .75em;font-family:Helvetica Neue,Helvetica,Arial,sans-serif}.resp-subscribe-button__icon svg{width:1em;height:1em;margin-right:.4em;vertical-align:top}.resp-subscribe-button--small svg{margin:0;vertical-align:middle}.resp-subscribe-button__icon{stroke:#fff;fill:none}.resp-subscribe-button__icon--solid,.resp-subscribe-button__icon--solidcircle{fill:#fff;stroke:none}.resp-subscribe-button--coffee{background-color:#d9534f}.resp-subscribe-button--coffee:hover{background-color:#c0312c}.resp-subscribe-button--coffee{background-color:#d9534f;border-color:#d9534f}.resp-subscribe-button--coffee:hover,.resp-subscribe-button--coffee:active{background-color:#c0312c;border-color:#c0312c}.resp-subscribe-button--github{background-color:#3b3b3b}.resp-subscribe-button--github:hover{background-color:#292929}.resp-subscribe-button--github{background-color:#3b3b3b;border-color:#3b3b3b}.resp-subscribe-button--github:hover,.resp-subscribe-button--github:active{background-color:#292929;border-color:#292929}.subscribe-title{display:block;font-size:1.5em;margin-block-start:.83em;margin-block-end:.83em;margin-inline-start:0;margin-inline-end:0;font-weight:700;color:var(--card-text-color-main)}</style><span class=subscribe-title>Support me</span><div><a class="resp-subscribe-button__link umami--click--support-kofi" href=https://ko-fi.com/genezini target=_blank value="☕ Ko-fi" aria-label="☕ Ko-fi"><div class="resp-subscribe-button resp-subscribe-button--coffee resp-subscribe-button--medium"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-mug" width="16" height="16" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4.083 5h10.834A1.08 1.08.0 0116 6.077v8.615C16 17.072 14.06 19 11.667 19H7.333C4.94 19 3 17.071 3 14.692V6.077A1.08 1.08.0 014.083 5"/><path d="M16 8h2.5c1.38.0 2.5 1.045 2.5 2.333v2.334C21 13.955 19.88 15 18.5 15H16"/></svg>Ko-fi</div></a><a class="resp-subscribe-button__link umami--click--support-github" href=https://github.com/sponsors/dgenezini/ target=_blank value="GitHub Sponsor" aria-label="GitHub Sponsor"><div class="resp-subscribe-button resp-subscribe-button--github resp-subscribe-button--medium"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="16" height="16" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg>GitHub Sponsor</div></a></div><span class=subscribe-title>Tags</span><section class=article-tags><a href=/tags/c-sharp/ class=umami--click--tags-bottom--tags-c-sharp->C#</a>
<a href=/tags/dotnet/ class=umami--click--tags-bottom--tags-dotnet->.NET</a>
<a href=/tags/aws/ class=umami--click--tags-bottom--tags-aws->AWS</a>
<a href=/tags/testcontainers/ class=umami--click--tags-bottom--tags-testcontainers->Testcontainers</a>
<a href=/tags/localstack/ class=umami--click--tags-bottom--tags-localstack->LocalStack</a>
<a href=/tags/docker/ class=umami--click--tags-bottom--tags-docker->Docker</a>
<a href=/tags/containers/ class=umami--click--tags-bottom--tags-containers->Containers</a>
<a href=/tags/tests/ class=umami--click--tags-bottom--tags-tests->Tests</a>
<a href=/tags/automated-tests/ class=umami--click--tags-bottom--tags-automated-tests->Automated Tests</a>
<a href=/tags/integration-tests/ class=umami--click--tags-bottom--tags-integration-tests->Integration Tests</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/p/dotnet-and-aws-s3-with-localstack-how-to-develop-with-local-s3-buckets/ class=umami--click--related-bottom-dotnet-and-aws-s3-with-localstack-how-to-develop-with-local-s3-buckets-><div class=article-image><img src=/p/dotnet-and-aws-s3-with-localstack-how-to-develop-with-local-s3-buckets/cover.915aca9e18506ac916e33a526f46e8e6.jpg width=1000 height=621 loading=lazy alt="Featured image of post .NET and AWS S3 with LocalStack: How to develop with local S3 buckets" data-key=dotnet-and-aws-s3-with-localstack-how-to-develop-with-local-s3-buckets data-hash="md5-kVrKnhhQaskW4zpSb0bo5g=="></div><div class=article-details><h2 class=article-title>.NET and AWS S3 with LocalStack: How to develop with local S3 buckets</h2></div></a></article><article class=has-image><a href=/p/how-to-run-disposable-databases-for-your-tests.-improve-your-integration-tests-accuracy-with-testcontainers/ class=umami--click--related-bottom-how-to-run-disposable-databases-for-your-tests-improve-your-integration-tests-accuracy-with-testcontainers-><div class=article-image><img src=/p/how-to-run-disposable-databases-for-your-tests.-improve-your-integration-tests-accuracy-with-testcontainers/cover.17fdf319df56995a125eda70a2ad44ab.jpg width=1000 height=667 loading=lazy alt="Featured image of post How to run disposable databases for your tests. Improve your integration tests accuracy with Testcontainers" data-hash="md5-F/3zGd9WmVoSXtpwoq1Eqw=="></div><div class=article-details><h2 class=article-title>How to run disposable databases for your tests. Improve your integration tests accuracy with Testcontainers</h2></div></a></article><article class=has-image><a href=/p/why-my-wiremock-mocks-arent-working/ class=umami--click--related-bottom-why-my-wiremock-mocks-arent-working-><div class=article-image><img src=/p/why-my-wiremock-mocks-arent-working/cover.f70813e54c76069272ea9d6978241d4d.jpg width=800 height=533 loading=lazy alt="Featured image of post Why my WireMock mocks aren't working?" data-hash="md5-9wgT5Ux2BpJy6p1peCQdTQ=="></div><div class=article-details><h2 class=article-title>Why my WireMock mocks aren't working?</h2></div></a></article><article class=has-image><a href=/p/analyzing-and-enforcing-.net-code-coverage-with-coverlet/ class=umami--click--related-bottom-analyzing-and-enforcing-net-code-coverage-with-coverlet-><div class=article-image><img src=/p/analyzing-and-enforcing-.net-code-coverage-with-coverlet/cover.4f8029464d90450d6f2a4bf48bcd8091.png width=1300 height=250 loading=lazy alt="Featured image of post Analyzing and enforcing .NET code coverage with coverlet" data-hash="md5-T4ApRk2QRQ1vKkv0i82AkQ=="></div><div class=article-details><h2 class=article-title>Analyzing and enforcing .NET code coverage with coverlet</h2></div></a></article><article class=has-image><a href=/p/integration-tests-without-api-dependencies-with-asp.net-core-and-wiremock.net/ class=umami--click--related-bottom-integration-tests-without-api-dependencies-with-aspnet-core-and-wiremocknet-><div class=article-image><img src=/p/integration-tests-without-api-dependencies-with-asp.net-core-and-wiremock.net/cover.8ef585ee0207271aef85e7771afce426.jpg width=800 height=534 loading=lazy alt="Featured image of post Integration tests without API dependencies with ASP.NET Core and WireMock.Net" data-hash="md5-jvWF7gIHJxrvhed3GvzkJg=="></div><div class=article-details><h2 class=article-title>Integration tests without API dependencies with ASP.NET Core and WireMock.Net</h2></div></a></article></div></div></aside><div id=comments><script src=https://giscus.app/client.js data-repo=dgenezini/BlogComments data-repo-id=R_kgDOJj-XAw data-category=Announcements data-category-id=DIC_kwDOJj-XA84CWiZs data-mapping=og:title data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=light data-lang=en data-loading=lazy crossorigin=anonymous async></script>
<script>function setGiscusTheme(e){let t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:{setConfig:{theme:e}}},"https://giscus.app")}(function(){addEventListener("message",t=>{if(event.origin!=="https://giscus.app")return;e()}),window.addEventListener("onColorSchemeChange",e);function e(){setGiscusTheme(document.documentElement.dataset.scheme==="light"?"light":"dark_dimmed")}})()</script></div><footer class=site-footer><section class=copyright>&copy;
2022 -
2023 Daniel Genezini | It works on my machine</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.13.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main><aside class="sidebar right-sidebar sticky"><section class="widget archives"><h2 class="widget-title section-title">Related content</h2><div class=article-list--mini><article><a href=/p/dotnet-and-aws-s3-with-localstack-how-to-develop-with-local-s3-buckets/ class=umami--click--related-side-dotnet-and-aws-s3-with-localstack-how-to-develop-with-local-s3-buckets-><div class=article-details><h2 class=article-title>.NET and AWS S3 with LocalStack: How to develop with local S3 buckets</h2><footer class=article-time><time datetime=2023-02-13T07:30:00-03:00>13 Feb 2023</time></footer></div><div class=article-image><img src=/p/dotnet-and-aws-s3-with-localstack-how-to-develop-with-local-s3-buckets/cover.jpg width=1000 height=621 alt=".NET and AWS S3 with LocalStack: How to develop with local S3 buckets" loading=lazy></div></a></article><article><a href=/p/how-to-run-disposable-databases-for-your-tests.-improve-your-integration-tests-accuracy-with-testcontainers/ class=umami--click--related-side-how-to-run-disposable-databases-for-your-tests--improve-your-integration-tests-accuracy-with-testcontainers-><div class=article-details><h2 class=article-title>How to run disposable databases for your tests. Improve your integration tests accuracy with Testcontainers</h2><footer class=article-time><time datetime=2023-01-09T07:00:00-03:00>09 Jan 2023</time></footer></div><div class=article-image><img src=/p/how-to-run-disposable-databases-for-your-tests.-improve-your-integration-tests-accuracy-with-testcontainers/cover.jpg width=1000 height=667 alt="How to run disposable databases for your tests. Improve your integration tests accuracy with Testcontainers" loading=lazy></div></a></article><article><a href=/p/why-my-wiremock-mocks-arent-working/ class=umami--click--related-side-why-my-wiremock-mocks-arent-working-><div class=article-details><h2 class=article-title>Why my WireMock mocks aren't working?</h2><footer class=article-time><time datetime=2023-04-11T08:00:00-03:00>11 Apr 2023</time></footer></div><div class=article-image><img src=/p/why-my-wiremock-mocks-arent-working/cover.jpg width=800 height=533 alt="Why my WireMock mocks aren't working?" loading=lazy></div></a></article><article><a href=/p/analyzing-and-enforcing-.net-code-coverage-with-coverlet/ class=umami--click--related-side-analyzing-and-enforcing--net-code-coverage-with-coverlet-><div class=article-details><h2 class=article-title>Analyzing and enforcing .NET code coverage with coverlet</h2><footer class=article-time><time datetime=2022-11-03T08:10:00-03:00>03 Nov 2022</time></footer></div><div class=article-image><img src=/p/analyzing-and-enforcing-.net-code-coverage-with-coverlet/cover.png width=1300 height=250 alt="Analyzing and enforcing .NET code coverage with coverlet" loading=lazy></div></a></article><article><a href=/p/integration-tests-without-api-dependencies-with-asp.net-core-and-wiremock.net/ class=umami--click--related-side-integration-tests-without-api-dependencies-with-asp-net-core-and-wiremock-net-><div class=article-details><h2 class=article-title>Integration tests without API dependencies with ASP.NET Core and WireMock.Net</h2><footer class=article-time><time datetime=2022-09-25T08:00:00-03:00>25 Sep 2022</time></footer></div><div class=article-image><img src=/p/integration-tests-without-api-dependencies-with-asp.net-core-and-wiremock.net/cover.jpg width=800 height=534 alt="Integration tests without API dependencies with ASP.NET Core and WireMock.Net" loading=lazy></div></a></article></div></section><section class="widget archives"><h2 class="widget-title section-title">Recent posts</h2><div class=article-list--mini><article><a href=/p/lessons-learned-from-building-a-static-code-analyzer-for-csharp/ class=umami--click--recentposts-lessons-learned-from-building-a-static-code-analyzer-for-csharp-><div class=article-details><h2 class=article-title>Lessons learned from building a static code analyzer for C#</h2><footer class=article-time><time datetime=2023-07-12T20:15:00-03:00>12 Jul 2023</time></footer></div><div class=article-image><img src=/p/lessons-learned-from-building-a-static-code-analyzer-for-csharp/cover.jpg width=1000 height=563 alt="Lessons learned from building a static code analyzer for C#" loading=lazy></div></a></article><article><a href=/p/building-a-whos-that-pokemon-game-for-android-with-net-maui-and-blazor-hybrid/ class=umami--click--recentposts-building-a-whos-that-pokemon-game-for-android-with-net-maui-and-blazor-hybrid-><div class=article-details><h2 class=article-title>Building a Who's that Pokémon game for Android with .NET MAUI and Blazor Hybrid</h2><footer class=article-time><time datetime=2023-06-28T06:00:00-03:00>28 Jun 2023</time></footer></div><div class=article-image><img src=/p/building-a-whos-that-pokemon-game-for-android-with-net-maui-and-blazor-hybrid/cover.jpg width=800 height=500 alt="Building a Who's that Pokémon game for Android with .NET MAUI and Blazor Hybrid" loading=lazy></div></a></article><article><a href=/p/how-to-run-scripts-on-sql-server-container-startup/ class=umami--click--recentposts-how-to-run-scripts-on-sql-server-container-startup-><div class=article-details><h2 class=article-title>How to run scripts on SQL Server container startup</h2><footer class=article-time><time datetime=2023-05-15T06:00:00-03:00>15 May 2023</time></footer></div><div class=article-image><img src=/p/how-to-run-scripts-on-sql-server-container-startup/cover.jpg width=800 height=450 alt="How to run scripts on SQL Server container startup" loading=lazy></div></a></article><article><a href=/p/real-time-charts-with-blazor-signalr-and-apexcharts/ class=umami--click--recentposts-real-time-charts-with-blazor-signalr-and-apexcharts-><div class=article-details><h2 class=article-title>Real-time charts with Blazor, SignalR and ApexCharts</h2><footer class=article-time><time datetime=2023-05-02T06:00:00-03:00>02 May 2023</time></footer></div><div class=article-image><img src=/p/real-time-charts-with-blazor-signalr-and-apexcharts/cover.jpg width=1000 height=667 alt="Real-time charts with Blazor, SignalR and ApexCharts" loading=lazy></div></a></article><article><a href=/p/easier-git-rebase-of-messy-branches/ class=umami--click--recentposts-easier-git-rebase-of-messy-branches-><div class=article-details><h2 class=article-title>Easier Git rebase of messy branches</h2><footer class=article-time><time datetime=2023-04-18T09:40:00-03:00>18 Apr 2023</time></footer></div><div class=article-image><img src=/p/easier-git-rebase-of-messy-branches/cover.jpg width=1000 height=600 alt="Easier Git rebase of messy branches" loading=lazy></div></a></article></div></section></aside></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script><script src=https://storage.ko-fi.com/cdn/scripts/overlay-widget.js></script>
<script>kofiWidgetOverlay.draw("genezini",{type:"floating-chat","floating-chat.donateButton.text":"Support me","floating-chat.donateButton.background-color":"#d9534f","floating-chat.donateButton.text-color":"#fff"})</script></body></html>