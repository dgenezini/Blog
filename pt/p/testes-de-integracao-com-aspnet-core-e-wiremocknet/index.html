<!doctype html><html lang=pt-br dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content='Criando mocks para APIs com WireMock.Net'><title>Testes de integração sem dependências de APIs com ASP.NET Core e WireMock.Net</title>
<link rel=canonical href=https://blog.genezini.com/pt/p/testes-de-integracao-com-aspnet-core-e-wiremocknet/><link rel=alternate href=https://blog.genezini.com/ hreflang=x-default><link rel=stylesheet href=/scss/style.min.e3e9c075987ec9abe7be9200a4fe17175980754b0c822a22c3165916d315251e.css><meta property='og:title' content='Testes de integração sem dependências de APIs com ASP.NET Core e WireMock.Net'><meta property='og:description' content='Criando mocks para APIs com WireMock.Net'><meta property='og:url' content='https://blog.genezini.com/pt/p/testes-de-integracao-com-aspnet-core-e-wiremocknet/'><meta property='og:site_name' content='Daniel Genezini | It works on my machine'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='Testes'><meta property='article:tag' content='Testes Automatizados'><meta property='article:tag' content='Testes de Integração'><meta property='article:tag' content='WireMock.Net'><meta property='article:tag' content='ASP.NET Core'><meta property='article:tag' content='dotnet'><meta property='article:tag' content='C#'><meta property='article:published_time' content='2022-09-21T08:00:00-03:00'><meta property='article:modified_time' content='2022-09-21T08:00:00-03:00'><meta property='og:image' content='https://blog.genezini.com/p/integration-tests-without-api-dependencies-with-asp.net-core-and-wiremock.net/cover.jpg'><meta name=twitter:title content="Testes de integração sem dependências de APIs com ASP.NET Core e WireMock.Net"><meta name=twitter:description content="Criando mocks para APIs com WireMock.Net"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://blog.genezini.com/p/integration-tests-without-api-dependencies-with-asp.net-core-and-wiremock.net/cover.jpg'><script async src="https://www.googletagmanager.com/gtag/js?id=G-029SLZEC4C"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-029SLZEC4C",{anonymize_ip:!1})}</script><script async defer data-website-id=05387238-0856-4199-8d28-696e4a1d7322 src=https://sparkling-pixie-afead0.netlify.app/tomato.js></script></head><body class="article-page
//"><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Alternar Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><div class=site-meta><h1 class=site-name><a href=/pt>It works on my machine</a></h1></div><figure class=site-avatar><a href=/pt/><img src=/img/avatar_hu793066471163999a4414bfb3be66f111_30130_300x0_resize_q75_box.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><span class=site-name>Daniel Genezini</span></header><ol class=social-menu><li><a class=umami--click--socialmenu-GitHub href=https://github.com/dgenezini/ target=_blank title=GitHub><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a class=umami--click--socialmenu-Linkedin href=https://www.linkedin.com/in/danielgenezini/ target=_blank title=Linkedin><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-linkedin" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><rect x="4" y="4" width="16" height="16" rx="2"/><line x1="8" y1="11" x2="8" y2="16"/><line x1="8" y1="8" x2="8" y2="8.01"/><line x1="12" y1="16" x2="12" y2="11"/><path d="M16 16v-3a2 2 0 00-4 0"/></svg></a></li><li><a class=umami--click--socialmenu-Mastodon href=https://mastodon.world/@danielgenezini target=_blank title=Mastodon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-mastodon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18.648 15.254C16.832 17.017 12 16.88 12 16.88a18.262 18.262.0 01-3.288-.256c1.127 1.985 4.12 2.81 8.982 2.475-1.945 2.013-13.598 5.257-13.668-7.636L4 10.309c0-3.036.023-4.115 1.352-5.633C7.023 2.766 12 3.01 12 3.01s4.977-.243 6.648 1.667C19.977 6.195 20 7.274 20 10.31s-.456 4.074-1.352 4.944z"/><path d="M12 11.204V8.278C12 7.02 11.105 6 10 6S8 7.02 8 8.278V13m4-4.722C12 7.02 12.895 6 14 6s2 1.02 2 2.278V13"/></svg></a></li><li><a class=umami--click--socialmenu-Twitter href=https://twitter.com/GeneziniDaniel target=_blank title=Twitter><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/pt/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/pt/arquivo/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Arquivo</span></a></li><li><a href=/pt/pesquisar/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Pesquisar</span></a></li><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Modo Escuro</span></li></div></ol></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/pt/p/testes-de-integracao-com-aspnet-core-e-wiremocknet/><img src=/p/integration-tests-without-api-dependencies-with-asp.net-core-and-wiremock.net/cover.jpg width=800 height=534 loading=lazy alt="Featured image of post Testes de integração sem dependências de APIs com ASP.NET Core e WireMock.Net"></a></div><div class=picture-credits><a href=https://unsplash.com/photos/9vQG6v1md1s target=_blank>Picture by Ryutaro Uozumi</a></div><div class=article-details><header class=article-category><a href=/pt/categories/testes/ class=umami--click--categories-header--pt-categories-testes->Testes
</a><a href=/pt/categories/dotnet/ class=umami--click--categories-header--pt-categories-dotnet->.NET
</a><a href=/pt/categories/asp.net-core/ class=umami--click--categories-header--pt-categories-asp-net-core->ASP.NET Core
</a><a href=/pt/categories/c-sharp/ class=umami--click--categories-header--pt-categories-c-sharp->C#</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/pt/p/testes-de-integracao-com-aspnet-core-e-wiremocknet/>Testes de integração sem dependências de APIs com ASP.NET Core e WireMock.Net</a></h2><h3 class=article-subtitle>Criando mocks para APIs com WireMock.Net</h3></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>7 minutos de leitura
</time><a href=/follow-me/ aria-label="Follow me"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-rss" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="5" cy="19" r="1"/><path d="M4 4a16 16 0 0116 16"/><path d="M4 11a9 9 0 019 9"/></svg>
<span>Follow me</span>
</a><a data-pocket-label=pocket data-save-url=https://blog.genezini.com/pt/p/testes-de-integracao-com-aspnet-core-e-wiremocknet/ data-pocket-count=none class=pocket-btn data-lang=en></a><script type=text/javascript>!function(e,t){if(!e.getElementById(t)){var s,n=e.createElement("script");n.id=t,n.src="https://widgets.getpocket.com/v1/j/btn.js?v=1",s=e.getElementById(t),e.body.appendChild(n)}}(document,"pocket-btn-js")</script></div></footer><footer class=article-translations><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 5h7"/><path d="M9 3v2c0 4.418-2.239 8-5 8"/><path d="M5 9c-.003 2.144 2.952 3.908 6.7 4"/><path d="M12 20l4-9 4 9"/><path d="M19.1 18h-6.2"/></svg><div><a href=https://blog.genezini.com/p/integration-tests-without-api-dependencies-with-asp.net-core-and-wiremock.net/ class=link>🇬🇧 English</a></div></footer></div></header><section class=article-content><h2 id=introdução>Introdução <a href=#introdução class=header-link arialabel=Anchor><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Link to this section</title><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></a></h2><p>Embora não exista um consenso sobre o escopo de um teste de integração, Martin Fowler define testes de integração restritos (Narrow), nos quais a integração entre os sistemas é testada usando substitutos (Mocks), e testes de integração amplos (Broad), que se comunicam com APIs reais.</p><p>Nesse post, explicarei como criar mocks para APIs HTTP em testes de integração restritos usando a biblioteca <a class=link href=https://github.com/WireMock-Net/WireMock.Net target=_blank rel=noopener>WireMock.Net</a>.</p><h2 id=o-que-mockar>O que &ldquo;mockar&rdquo;? <a href=#o-que-mockar class=header-link arialabel=Anchor><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Link to this section</title><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></a></h2><p>Vladimir Khorikov tem um conceito de dependências gerenciadas e não gerenciadas, que considero complementar ao conceito de Martin Fowler, para escolhermos o que deve e o que não deve ser &ldquo;mockado&rdquo;.</p><p>Segundo Vladimir, dependências gerenciadas são sistemas externos controlados por nós e acessados apenas pela nossa aplicação (por exemplo, um banco de dados). Por outro lado, dependências não gerenciadas são sistemas externos não controlados por nós ou que são acessados também por outras aplicações (como uma API de terceiros e um message broker).</p><p>Vladimir defende que devemos fazer nossos testes de integração consumindo dependências gerenciadas e &ldquo;mockando&rdquo; dependências não gerenciadas. Eu acredito que essa definição serve mais como um norte do que como uma regra. Por exemplo, em um cenário onde nosso sistema posta mensagens em um message broker para outro sistema ler, ou seja, o message broker é uma dependência não gerenciada, podemos testar a integração com o message broker para validar que a mensagem está sendo postada no formato correto (contrato definido). Isso pode ser valioso para validar que atualizações na biblioteca usada para se comunicar com o message broker não modificou o formato e o conteúdo das mensagens.</p><h2 id=por-que-usar-mocks>Por que usar mocks? <a href=#por-que-usar-mocks class=header-link arialabel=Anchor><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Link to this section</title><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></a></h2><p>O intuito dos testes de integração restritos é testar se seus componentes, testados individualmente através de testes de unidade, funcionam corretamente de forma integrada entre si. Quando consumimos uma API, seguimos um protocolo e confiamos em um contrato de comunicação, isto é, que ela vai aceitar uma entrada X e retornar uma resposta Y.</p><p>Dessa forma, o funcionamento da API externa não está no escopo dos testes integrados.</p><p>Isso não exclui a necessidade de realizar testes funcionais; apenas diminui a quantidade necessária desses testes, que, em geral, são mais custosos de serem executados.</p><p>Restringindo os testes de integração apenas ao nosso sistema, temos alguns benefícios:</p><ul><li>Velocidade nos testes, pois retiramos a latência da rede;</li><li>Não dependência de dados para teste em sistemas externos;</li><li>Menor fragilidade dos testes, que podem quebrar em caso de instabilidade ou de dados que foram alterados nos sistemas externos, dificultando a interpretação dos resultados;</li><li>Maior confiança nos resultados dos testes.</li></ul><h2 id=usando-wiremockspanspannet>Usando WireMock<span>.</span>Net <a href=#usando-wiremockspanspannet class=header-link arialabel=Anchor><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Link to this section</title><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></a></h2><p>Nesse exemplo, construí uma API que usa o serviço PokéAPI para buscar os dados de um Pokémon e retornar os dados para o cliente da nossa API.</p><p><img src=/p/integration-tests-without-api-dependencies-with-asp.net-core-and-wiremock.net/images/Diagram1.png width=571 height=261 loading=lazy alt="Diagrama da API" class=gallery-image data-flex-grow=218 data-flex-basis=525px></p><h3 id=controller>Controller <a href=#controller class=header-link arialabel=Anchor><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Link to this section</title><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></a></h3><p>O controller é simples e usa a biblioteca <a class=link href=https://github.com/reactiveui/refit target=_blank rel=noopener>Refit</a> para abstrair a chamada da API e, por simplicidade, retorna o mesmo objeto.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=k>using</span> <span class=nn>Microsoft.AspNetCore.Mvc</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=nn>Refit</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>namespace</span> <span class=nn>PokemonInfoAPI.Controllers</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl><span class=na>    [ApiController]</span>
</span></span><span class=line><span class=cl><span class=na>    [Route(&#34;[controller]</span><span class=s>&#34;)]
</span></span></span><span class=line><span class=cl><span class=s></span>    <span class=kd>public</span> <span class=k>class</span> <span class=nc>PokemonInfoController</span> <span class=p>:</span> <span class=n>ControllerBase</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>private</span> <span class=k>readonly</span> <span class=n>IConfiguration</span> <span class=n>_configuration</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kd>public</span> <span class=n>PokemonInfoController</span><span class=p>(</span><span class=n>IConfiguration</span> <span class=n>configuration</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>_configuration</span> <span class=p>=</span> <span class=n>configuration</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=na>
</span></span></span><span class=line><span class=cl><span class=na>        [HttpGet(&#34;{pokemonName}&#34;)]</span>
</span></span><span class=line><span class=cl>        <span class=kd>public</span> <span class=kd>async</span> <span class=n>Task</span><span class=p>&lt;</span><span class=n>ActionResult</span><span class=p>&lt;</span><span class=n>PokemonInfo</span><span class=p>&gt;&gt;</span> <span class=n>GetAsync</span><span class=p>(</span><span class=kt>string</span> <span class=n>pokemonName</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>try</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=kt>var</span> <span class=n>pokeApi</span> <span class=p>=</span> <span class=n>RestService</span><span class=p>.</span><span class=n>For</span><span class=p>&lt;</span><span class=n>IPokeApi</span><span class=p>&gt;(</span><span class=n>_configuration</span><span class=p>[</span><span class=s>&#34;PokeApiBaseUrl&#34;</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>Ok</span><span class=p>(</span><span class=k>await</span> <span class=n>pokeApi</span><span class=p>.</span><span class=n>GetPokemonInfo</span><span class=p>(</span><span class=n>pokemonName</span><span class=p>));</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=k>catch</span> <span class=p>(</span><span class=n>ApiException</span> <span class=n>ex</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=p>(</span><span class=n>ex</span><span class=p>.</span><span class=n>StatusCode</span> <span class=p>==</span> <span class=n>System</span><span class=p>.</span><span class=n>Net</span><span class=p>.</span><span class=n>HttpStatusCode</span><span class=p>.</span><span class=n>NotFound</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=n>NotFound</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>StatusCode</span><span class=p>(</span><span class=m>500</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=teste-de-integração-padrão>Teste de integração padrão <a href=#teste-de-integração-padrão class=header-link arialabel=Anchor><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Link to this section</title><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></a></h3><p>Começamos com um teste de integração padrão, usando a classe WebApplicationFactory do ASP.NET Core.</p><p>O teste cria uma instância da nossa aplicação e faz uma chamada ao endpoint <code>/pokemoninfo</code> passando o parâmetro <code>charmander</code>. A chamada ao endpoint faz nossa aplicação chamar a API PokéAPI.</p><blockquote><p>💡 <strong>Você pode usar qualquer classe do projeto da API para instanciar o <code>WebApplicationFactory</code></strong> nos seus testes. Se estiver usando statements na sua aplicação, você pode usar a classe do controller. Por exemplo, <code>WebApplicationFactory&lt;PokemonInfoController></code>.</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=k>using</span> <span class=nn>FluentAssertions</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=nn>Microsoft.AspNetCore.Mvc.Testing</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=nn>System.Net</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=nn>System.Text.Json</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>namespace</span> <span class=nn>PokemonInfoAPI.IntegrationTests</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=k>class</span> <span class=nc>PokemonInfoTests</span><span class=p>:</span> <span class=n>IClassFixture</span><span class=p>&lt;</span><span class=n>WebApplicationFactory</span><span class=p>&lt;</span><span class=n>Program</span><span class=p>&gt;&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>private</span> <span class=k>readonly</span> <span class=n>WebApplicationFactory</span><span class=p>&lt;</span><span class=n>Program</span><span class=p>&gt;</span> <span class=n>_factory</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kd>public</span> <span class=n>PokemonInfoTests</span><span class=p>(</span><span class=n>WebApplicationFactory</span><span class=p>&lt;</span><span class=n>Program</span><span class=p>&gt;</span> <span class=n>factory</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>_factory</span> <span class=p>=</span> <span class=n>factory</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=na>
</span></span></span><span class=line><span class=cl><span class=na>        [Fact]</span>
</span></span><span class=line><span class=cl>        <span class=kd>public</span> <span class=kd>async</span> <span class=n>Task</span> <span class=n>Get_Existing_Pokemon_Returns_200</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=c1>//Arrange</span>
</span></span><span class=line><span class=cl>            <span class=kt>var</span> <span class=n>HttpClient</span> <span class=p>=</span> <span class=n>Factory</span><span class=p>.</span><span class=n>CreateClient</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=c1>//Act</span>
</span></span><span class=line><span class=cl>            <span class=kt>var</span> <span class=n>HttpResponse</span> <span class=p>=</span> <span class=k>await</span> <span class=n>HttpClient</span><span class=p>.</span><span class=n>GetAsync</span><span class=p>(</span><span class=s>&#34;/pokemoninfo/charmander&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=c1>//Assert</span>
</span></span><span class=line><span class=cl>            <span class=n>HttpResponse</span><span class=p>.</span><span class=n>StatusCode</span><span class=p>.</span><span class=n>Should</span><span class=p>().</span><span class=n>Be</span><span class=p>(</span><span class=n>HttpStatusCode</span><span class=p>.</span><span class=n>OK</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=kt>var</span> <span class=n>ResponseJson</span> <span class=p>=</span> <span class=k>await</span> <span class=n>HttpResponse</span><span class=p>.</span><span class=n>Content</span><span class=p>.</span><span class=n>ReadAsStringAsync</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=kt>var</span> <span class=n>PokemonInfo</span> <span class=p>=</span> <span class=n>JsonSerializer</span><span class=p>.</span><span class=n>Deserialize</span><span class=p>&lt;</span><span class=n>PokemonInfo</span><span class=p>&gt;(</span><span class=n>ResponseJson</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>PokemonInfo</span><span class=p>.</span><span class=n>Should</span><span class=p>().</span><span class=n>BeEquivalentTo</span><span class=p>(</span><span class=n>ResponseObj</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=criando-um-mock-para-o-sistema-externo-pokéapi>Criando um mock para o sistema externo PokéAPI <a href=#criando-um-mock-para-o-sistema-externo-pokéapi class=header-link arialabel=Anchor><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Link to this section</title><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></a></h3><p>O WireMock<span>.</span>Net é uma biblioteca que possibilita a criação de mocks para APIs HTTP. Ele cria um servidor web no mesmo processo dos nossos testes e expõe uma URL para ser acessada pela nossa aplicação.</p><p>Usando o WireMock.Net e o WebApplicationFactory teremos o seguinte cenário:</p><p><img src=/p/integration-tests-without-api-dependencies-with-asp.net-core-and-wiremock.net/images/Diagram2.png width=571 height=261 loading=lazy alt="Diagrama de um teste de integração usando WireMock.Net e WebApplicationFactory" class=gallery-image data-flex-grow=218 data-flex-basis=525px></p><p>Primeiro, instalo o pacote Nuget <code>WireMock.Net</code> no projeto de testes.</p><h4 id=utilizando-o-package-manager-pelo-visual-studio>Utilizando o Package Manager pelo Visual Studio <a href=#utilizando-o-package-manager-pelo-visual-studio class=header-link arialabel=Anchor><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Link to this section</title><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Install-Package WireMock.Net
</span></span></code></pre></div><p>Ou</p><h4 id=utilizando-o-net-cli-pela-linha-de-comando>Utilizando o .NET CLI pela linha de comando <a href=#utilizando-o-net-cli-pela-linha-de-comando class=header-link arialabel=Anchor><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Link to this section</title><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>dotnet add package WireMock.Net
</span></span></code></pre></div><h3 id=iniciando-o-servidor-do-wiremockspanspannet>Iniciando o servidor do WireMock<span>.</span>Net <a href=#iniciando-o-servidor-do-wiremockspanspannet class=header-link arialabel=Anchor><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Link to this section</title><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></a></h3><p>Para iniciar o servidor do WireMock<span>.</span>Net, chamo o método <code>Start</code> da classe <code>WireMockServer</code>, que retorna um objeto com os dados do servidor.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=kt>var</span> <span class=n>WireMockSvr</span> <span class=p>=</span> <span class=n>WireMockServer</span><span class=p>.</span><span class=n>Start</span><span class=p>();</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=sobrescrevendo-as-configurações-da-nossa-aplicação>Sobrescrevendo as configurações da nossa aplicação <a href=#sobrescrevendo-as-configurações-da-nossa-aplicação class=header-link arialabel=Anchor><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Link to this section</title><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></a></h3><p>Com o servidor iniciado, sobrescrevo o parâmetro <code>PokeApiBaseUrl</code>, que contém a URL do PokéAPI, nas configurações da minha aplicação usando o método <code>WithWebHostBuilder</code> do <code>WebApplicationFactory</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=kt>var</span> <span class=n>HttpClient</span> <span class=p>=</span> <span class=n>_factory</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>WithWebHostBuilder</span><span class=p>(</span><span class=n>builder</span> <span class=p>=&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>builder</span><span class=p>.</span><span class=n>UseSetting</span><span class=p>(</span><span class=s>&#34;PokeApiBaseUrl&#34;</span><span class=p>,</span> <span class=n>WireMockSvr</span><span class=p>.</span><span class=n>Url</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>CreateClient</span><span class=p>();</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=criando-o-mock-para-o-endpoint-pokemon>Criando o mock para o endpoint /pokemon <a href=#criando-o-mock-para-o-endpoint-pokemon class=header-link arialabel=Anchor><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Link to this section</title><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></a></h3><p>Em seguida, crio o mock para o endpoint <code>/pokemon</code> recebendo o parâmetro <code>charmander</code>.</p><p>No exemplo abaixo, estou usando o AutoFixture para gerar um objeto com valores aleatórios, que será retornado pelo mock.</p><blockquote><p>ℹ️ Usar um objeto me possibilita comparar o retorno do meu sistema com esse objeto, mas também é possível configurar o retorno a partir de um arquivo, utilizando <code>WithBodyFromFile</code>.</p></blockquote><p>Também configuro os Headers que serão retornados e o status HTTP.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=n>Fixture</span> <span class=n>fixture</span> <span class=p>=</span> <span class=k>new</span> <span class=n>Fixture</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>ResponseObj</span> <span class=p>=</span> <span class=n>fixture</span><span class=p>.</span><span class=n>Create</span><span class=p>&lt;</span><span class=n>PokemonInfo</span><span class=p>&gt;();</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>ResponseObjJson</span> <span class=p>=</span> <span class=n>JsonSerializer</span><span class=p>.</span><span class=n>Serialize</span><span class=p>(</span><span class=n>ResponseObj</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>WireMockSvr</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>Given</span><span class=p>(</span><span class=n>Request</span><span class=p>.</span><span class=n>Create</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=n>WithPath</span><span class=p>(</span><span class=s>&#34;/pokemon/charmander&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=n>UsingGet</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=n>RespondWith</span><span class=p>(</span><span class=n>Response</span><span class=p>.</span><span class=n>Create</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=n>WithBody</span><span class=p>(</span><span class=n>ResponseObjJson</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=n>WithHeader</span><span class=p>(</span><span class=s>&#34;Content-Type&#34;</span><span class=p>,</span> <span class=s>&#34;application/json&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=n>WithStatusCode</span><span class=p>(</span><span class=n>HttpStatusCode</span><span class=p>.</span><span class=n>OK</span><span class=p>));</span>
</span></span></code></pre></td></tr></table></div></div><p>Feito isso, minha aplicação instanciada dentro dos testes já estará consumindo o mock, em vez da API real.</p><h2 id=código-completo-do-teste>Código completo do teste <a href=#código-completo-do-teste class=header-link arialabel=Anchor><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Link to this section</title><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=na>[Fact]</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>async</span> <span class=n>Task</span> <span class=n>Get_Existing_Pokemon_Returns_200</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>//Arrange</span>
</span></span><span class=line><span class=cl>    <span class=kt>var</span> <span class=n>WireMockSvr</span> <span class=p>=</span> <span class=n>WireMockServer</span><span class=p>.</span><span class=n>Start</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>var</span> <span class=n>HttpClient</span> <span class=p>=</span> <span class=n>_factory</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=n>WithWebHostBuilder</span><span class=p>(</span><span class=n>builder</span> <span class=p>=&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>builder</span><span class=p>.</span><span class=n>UseSetting</span><span class=p>(</span><span class=s>&#34;PokeApiBaseUrl&#34;</span><span class=p>,</span> <span class=n>WireMockSvr</span><span class=p>.</span><span class=n>Url</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>})</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=n>CreateClient</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>Fixture</span> <span class=n>fixture</span> <span class=p>=</span> <span class=k>new</span> <span class=n>Fixture</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>var</span> <span class=n>ResponseObj</span> <span class=p>=</span> <span class=n>fixture</span><span class=p>.</span><span class=n>Create</span><span class=p>&lt;</span><span class=n>PokemonInfo</span><span class=p>&gt;();</span>
</span></span><span class=line><span class=cl>    <span class=kt>var</span> <span class=n>ResponseObjJson</span> <span class=p>=</span> <span class=n>JsonSerializer</span><span class=p>.</span><span class=n>Serialize</span><span class=p>(</span><span class=n>ResponseObj</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>WireMockSvr</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=n>Given</span><span class=p>(</span><span class=n>Request</span><span class=p>.</span><span class=n>Create</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=n>WithPath</span><span class=p>(</span><span class=s>&#34;/pokemon/charmander&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=n>UsingGet</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=n>RespondWith</span><span class=p>(</span><span class=n>Response</span><span class=p>.</span><span class=n>Create</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=n>WithBody</span><span class=p>(</span><span class=n>ResponseObjJson</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=n>WithHeader</span><span class=p>(</span><span class=s>&#34;Content-Type&#34;</span><span class=p>,</span> <span class=s>&#34;application/json&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=n>WithStatusCode</span><span class=p>(</span><span class=n>HttpStatusCode</span><span class=p>.</span><span class=n>OK</span><span class=p>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>//Act</span>
</span></span><span class=line><span class=cl>    <span class=kt>var</span> <span class=n>HttpResponse</span> <span class=p>=</span> <span class=k>await</span> <span class=n>HttpClient</span><span class=p>.</span><span class=n>GetAsync</span><span class=p>(</span><span class=s>&#34;/pokemoninfo/charmander&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>//Assert</span>
</span></span><span class=line><span class=cl>    <span class=n>HttpResponse</span><span class=p>.</span><span class=n>StatusCode</span><span class=p>.</span><span class=n>Should</span><span class=p>().</span><span class=n>Be</span><span class=p>(</span><span class=n>HttpStatusCode</span><span class=p>.</span><span class=n>OK</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>var</span> <span class=n>ResponseJson</span> <span class=p>=</span> <span class=k>await</span> <span class=n>HttpResponse</span><span class=p>.</span><span class=n>Content</span><span class=p>.</span><span class=n>ReadAsStringAsync</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=kt>var</span> <span class=n>PokemonInfo</span> <span class=p>=</span> <span class=n>JsonSerializer</span><span class=p>.</span><span class=n>Deserialize</span><span class=p>&lt;</span><span class=n>PokemonInfo</span><span class=p>&gt;(</span><span class=n>ResponseJson</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>PokemonInfo</span><span class=p>.</span><span class=n>Should</span><span class=p>().</span><span class=n>BeEquivalentTo</span><span class=p>(</span><span class=n>ResponseObj</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>WireMockSvr</span><span class=p>.</span><span class=n>Stop</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=exemplo-simulando-um-cenário-de-não-sucesso>Exemplo simulando um cenário de não sucesso <a href=#exemplo-simulando-um-cenário-de-não-sucesso class=header-link arialabel=Anchor><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Link to this section</title><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></a></h2><p>Pelo contrato da API, sabemos que ela retorna o status 404 (Not Found) quando recebe um pokémon inválido como parâmetro, então criei um mock que retorna esse status ao receber o parâmetro <code>picapau</code> e valido que o retorno da minha aplicação está correto.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=na>[Fact]</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>async</span> <span class=n>Task</span> <span class=n>Get_NotExisting_Pokemon_Returns_404</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>//Arrange</span>
</span></span><span class=line><span class=cl>    <span class=kt>var</span> <span class=n>WireMockSvr</span> <span class=p>=</span> <span class=n>WireMockServer</span><span class=p>.</span><span class=n>Start</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>var</span> <span class=n>Factory</span> <span class=p>=</span> <span class=n>_factory</span><span class=p>.</span><span class=n>WithWebHostBuilder</span><span class=p>(</span><span class=n>builder</span> <span class=p>=&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>builder</span><span class=p>.</span><span class=n>UseSetting</span><span class=p>(</span><span class=s>&#34;PokeApiBaseUrl&#34;</span><span class=p>,</span> <span class=n>WireMockSvr</span><span class=p>.</span><span class=n>Url</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>var</span> <span class=n>HttpClient</span> <span class=p>=</span> <span class=n>Factory</span><span class=p>.</span><span class=n>CreateClient</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>Fixture</span> <span class=n>fixture</span> <span class=p>=</span> <span class=k>new</span> <span class=n>Fixture</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>WireMockSvr</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=n>Given</span><span class=p>(</span><span class=n>Request</span><span class=p>.</span><span class=n>Create</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=n>WithPath</span><span class=p>(</span><span class=s>&#34;/pokemon/picapau&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=n>UsingGet</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=n>RespondWith</span><span class=p>(</span><span class=n>Response</span><span class=p>.</span><span class=n>Create</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=n>WithHeader</span><span class=p>(</span><span class=s>&#34;Content-Type&#34;</span><span class=p>,</span> <span class=s>&#34;application/json&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=n>WithStatusCode</span><span class=p>(</span><span class=n>HttpStatusCode</span><span class=p>.</span><span class=n>NotFound</span><span class=p>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>//Act</span>
</span></span><span class=line><span class=cl>    <span class=kt>var</span> <span class=n>HttpResponse</span> <span class=p>=</span> <span class=k>await</span> <span class=n>HttpClient</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=n>GetAsync</span><span class=p>(</span><span class=s>&#34;/pokemoninfo/picapau&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>//Assert</span>
</span></span><span class=line><span class=cl>    <span class=n>HttpResponse</span><span class=p>.</span><span class=n>StatusCode</span><span class=p>.</span><span class=n>Should</span><span class=p>().</span><span class=n>Be</span><span class=p>(</span><span class=n>HttpStatusCode</span><span class=p>.</span><span class=n>NotFound</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>WireMockSvr</span><span class=p>.</span><span class=n>Stop</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=fonte-completo>Fonte completo <a href=#fonte-completo class=header-link arialabel=Anchor><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Link to this section</title><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></a></h2><p><a class=link href=https://github.com/dgenezini/PokemonInfoAPIWireMockTests target=_blank rel=noopener>https://github.com/dgenezini/PokemonInfoAPIWireMockTests</a></p><h2 id=referências-e-links>Referências e links <a href=#referências-e-links class=header-link arialabel=Anchor><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Link to this section</title><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></a></h2><ul><li><a class=link href=https://martinfowler.com/bliki/IntegrationTest.html target=_blank rel=noopener>https://martinfowler.com/bliki/IntegrationTest.html</a></li><li><a class=link href=https://khorikov.org/posts/2021-11-29-unmanaged-dependencies-explained/ target=_blank rel=noopener>https://khorikov.org/posts/2021-11-29-unmanaged-dependencies-explained/</a></li><li><a class=link href=https://github.com/WireMock-Net/WireMock.Net target=_blank rel=noopener>https://github.com/WireMock-Net/WireMock.Net</a></li><li><a class=link href=https://github.com/reactiveui/refit target=_blank rel=noopener>https://github.com/reactiveui/refit</a></li><li><a class=link href=https://github.com/AutoFixture/AutoFixture target=_blank rel=noopener>https://github.com/AutoFixture/AutoFixture</a></li><li><a class=link href=https://github.com/fluentassertions/fluentassertions target=_blank rel=noopener>https://github.com/fluentassertions/fluentassertions</a></li></ul></section><footer class=article-footer><style>.comment-content{margin:var(--card-padding)0;color:var(--card-text-color-main);font-family:var(--article-font-family);font-size:calc(var(--article-font-size) * 1.1);line-height:var(--article-line-height)}</style><span class=comment-content>💬 Like or have something to add? <a href=#comments>Leave a comment below</a>.</span><style>.resp-sharing-button__link,.resp-sharing-button__icon{display:inline-block}.resp-sharing-button__link{text-decoration:none;color:#fff;margin:0 .5em .5em 0}.resp-sharing-button{border-radius:5px;transition:25ms ease-out;padding:.5em .75em;font-family:Helvetica Neue,Helvetica,Arial,sans-serif}.resp-sharing-button__icon svg{width:1em;height:1em;margin-right:.4em;vertical-align:top}.resp-sharing-button--small svg{margin:0;vertical-align:middle}.resp-sharing-button__icon{stroke:#fff;fill:none}.resp-sharing-button__icon--solid,.resp-sharing-button__icon--solidcircle{fill:#fff;stroke:none}.resp-sharing-button--twitter{background-color:#55acee}.resp-sharing-button--twitter:hover{background-color:#2795e9}.resp-sharing-button--pinterest{background-color:#bd081c}.resp-sharing-button--pinterest:hover{background-color:#8c0615}.resp-sharing-button--facebook{background-color:#3b5998}.resp-sharing-button--facebook:hover{background-color:#2d4373}.resp-sharing-button--tumblr{background-color:#35465c}.resp-sharing-button--tumblr:hover{background-color:#222d3c}.resp-sharing-button--reddit{background-color:#ff4500}.resp-sharing-button--reddit:hover{background-color:#d43b03}.resp-sharing-button--google{background-color:#dd4b39}.resp-sharing-button--google:hover{background-color:#c23321}.resp-sharing-button--linkedin{background-color:#0077b5}.resp-sharing-button--linkedin:hover{background-color:#046293}.resp-sharing-button--email{background-color:#777}.resp-sharing-button--email:hover{background-color:#5e5e5e}.resp-sharing-button--xing{background-color:#1a7576}.resp-sharing-button--xing:hover{background-color:#114c4c}.resp-sharing-button--whatsapp{background-color:#25d366}.resp-sharing-button--whatsapp:hover{background-color:#1da851}.resp-sharing-button--hackernews{background-color:#f60}.resp-sharing-button--hackernews:hover,.resp-sharing-button--hackernews:focus{background-color:#fb6200}.resp-sharing-button--vk{background-color:#507299}.resp-sharing-button--vk:hover{background-color:#43648c}.resp-sharing-button--facebook{background-color:#3b5998;border-color:#3b5998}.resp-sharing-button--facebook:hover,.resp-sharing-button--facebook:active{background-color:#2d4373;border-color:#2d4373}.resp-sharing-button--twitter{background-color:#55acee;border-color:#55acee}.resp-sharing-button--twitter:hover,.resp-sharing-button--twitter:active{background-color:#2795e9;border-color:#2795e9}.resp-sharing-button--tumblr{background-color:#35465c;border-color:#35465c}.resp-sharing-button--tumblr:hover,.resp-sharing-button--tumblr:active{background-color:#222d3c;border-color:#222d3c}.resp-sharing-button--email{background-color:#777;border-color:#777}.resp-sharing-button--email:hover,.resp-sharing-button--email:active{background-color:#5e5e5e;border-color:#5e5e5e}.resp-sharing-button--pinterest{background-color:#bd081c;border-color:#bd081c}.resp-sharing-button--pinterest:hover,.resp-sharing-button--pinterest:active{background-color:#8c0615;border-color:#8c0615}.resp-sharing-button--linkedin{background-color:#0077b5;border-color:#0077b5}.resp-sharing-button--linkedin:hover,.resp-sharing-button--linkedin:active{background-color:#046293;border-color:#046293}.resp-sharing-button--reddit{background-color:#ff4500;border-color:#bb3200}.resp-sharing-button--reddit:hover,.resp-sharing-button--reddit:active{background-color:#d43b03;border-color:#bb3200}.resp-sharing-button--feedly{background-color:#2bb24c}.resp-sharing-button--feedly:hover{background-color:#249440}.resp-sharing-button--feedly{background-color:#2bb24c;border-color:#2bb24c}.resp-sharing-button--feedly:hover,.resp-sharing-button--feedly:active{background-color:#249440;border-color:#249440}.resp-sharing-button--rss{background-color:#f26522}.resp-sharing-button--rss:hover{background-color:#cc541d}.resp-sharing-button--rss{background-color:#f26522;border-color:#f26522}.resp-sharing-button--rss:hover,.resp-sharing-button--rss:active{background-color:#cc541d;border-color:#cc541d}.resp-sharing-button--mastodon{background-color:#6364ff}.resp-sharing-button--mastodon:hover{background-color:#4646cc}.resp-sharing-button--mastodon{background-color:#6364ff;border-color:#6364ff}.resp-sharing-button--mastodon:hover,.resp-sharing-button--mastodon:active{background-color:#4646cc;border-color:#4646cc}.share-on-title{display:block;font-size:1.5em;margin-block-start:.83em;margin-block-end:.83em;margin-inline-start:0;margin-inline-end:0;font-weight:700;color:var(--card-text-color-main)}</style><span class=share-on-title>Follow me</span><div><a class="resp-sharing-button__link umami--click--follow-feedly" href=https://feedly.com/i/subscription/feed/https://blog.genezini.com/index.xml target=_blank value=Subscribe aria-label=Subscribe><div class="resp-sharing-button resp-sharing-button--feedly resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-rss" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="5" cy="19" r="1"/><path d="M4 4a16 16 0 0116 16"/><path d="M4 11a9 9 0 019 9"/></svg></div>Feedly</div></a><a class="resp-sharing-button__link umami--click--follow-rss" href=/index.xml target=_blank value=Subscribe aria-label=Subscribe><div class="resp-sharing-button resp-sharing-button--rss resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-rss" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="5" cy="19" r="1"/><path d="M4 4a16 16 0 0116 16"/><path d="M4 11a9 9 0 019 9"/></svg></div>RSS</div></a><a class="resp-sharing-button__link umami--click--follow-twitter" href=https://twitter.com/GeneziniDaniel target=_blank rel=noopener aria-label=Twitter><div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M23.44 4.83c-.8.37-1.5.38-2.22.02.93-.56.98-.96 1.32-2.02-.88.52-1.86.9-2.9 1.1-.82-.88-2-1.43-3.3-1.43-2.5.0-4.55 2.04-4.55 4.54.0.36.03.7.1 1.04-3.77-.2-7.12-2-9.36-4.75-.4.67-.6 1.45-.6 2.3.0 1.56.8 2.95 2 3.77-.74-.03-1.44-.23-2.05-.57v.06c0 2.2 1.56 4.03 3.64 4.44-.67.2-1.37.2-2.06.08.58 1.8 2.26 3.12 4.25 3.16C5.78 18.1 3.37 18.74 1 18.46c2 1.3 4.4 2.04 6.97 2.04 8.35.0 12.92-6.92 12.92-12.93.0-.2.0-.4-.02-.6.9-.63 1.96-1.22 2.56-2.14z"/></svg></div>Twitter</div></a><a class="resp-sharing-button__link umami--click--follow-linkedin" href=https://www.linkedin.com/in/danielgenezini/ target=_blank rel=noopener aria-label=LinkedIn><div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6.5 21.5h-5v-13h5v13zM4 6.5C2.5 6.5 1.5 5.3 1.5 4s1-2.4 2.5-2.4c1.6.0 2.5 1 2.6 2.5.0 1.4-1 2.5-2.6 2.5zm11.5 6c-1 0-2 1-2 2v7h-5v-13h5V10s1.6-1.5 4-1.5c3 0 5 2.2 5 6.3v6.7h-5v-7c0-1-1-2-2-2z"/></svg></div>LinkedIn</div></a><a class="resp-sharing-button__link umami--click--follow-mastodon" href=https://mastodon.world/@danielgenezini target=_blank rel=noopener aria-label=Mastodon><div class="resp-sharing-button resp-sharing-button--mastodon resp-sharing-button--medium"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-mastodon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18.648 15.254C16.832 17.017 12 16.88 12 16.88a18.262 18.262.0 01-3.288-.256c1.127 1.985 4.12 2.81 8.982 2.475-1.945 2.013-13.598 5.257-13.668-7.636L4 10.309c0-3.036.023-4.115 1.352-5.633C7.023 2.766 12 3.01 12 3.01s4.977-.243 6.648 1.667C19.977 6.195 20 7.274 20 10.31s-.456 4.074-1.352 4.944z"/><path d="M12 11.204V8.278C12 7.02 11.105 6 10 6S8 7.02 8 8.278V13m4-4.722C12 7.02 12.895 6 14 6s2 1.02 2 2.278V13"/></svg></div>Mastodon</div></a></div><style>.resp-subscribe-button__link,.resp-subscribe-button__icon{display:inline-block}.resp-subscribe-button__link{text-decoration:none;color:#fff;margin:0 .5em .5em 0}.resp-subscribe-button{border-radius:5px;transition:25ms ease-out;padding:.5em .75em;font-family:Helvetica Neue,Helvetica,Arial,sans-serif}.resp-subscribe-button__icon svg{width:1em;height:1em;margin-right:.4em;vertical-align:top}.resp-subscribe-button--small svg{margin:0;vertical-align:middle}.resp-subscribe-button__icon{stroke:#fff;fill:none}.resp-subscribe-button__icon--solid,.resp-subscribe-button__icon--solidcircle{fill:#fff;stroke:none}.resp-subscribe-button--coffee{background-color:#d9534f}.resp-subscribe-button--coffee:hover{background-color:#c0312c}.resp-subscribe-button--coffee{background-color:#d9534f;border-color:#d9534f}.resp-subscribe-button--coffee:hover,.resp-subscribe-button--coffee:active{background-color:#c0312c;border-color:#c0312c}.resp-subscribe-button--github{background-color:#3b3b3b}.resp-subscribe-button--github:hover{background-color:#292929}.resp-subscribe-button--github{background-color:#3b3b3b;border-color:#3b3b3b}.resp-subscribe-button--github:hover,.resp-subscribe-button--github:active{background-color:#292929;border-color:#292929}.subscribe-title{display:block;font-size:1.5em;margin-block-start:.83em;margin-block-end:.83em;margin-inline-start:0;margin-inline-end:0;font-weight:700;color:var(--card-text-color-main)}</style><span class=subscribe-title>Support me</span><div><a class="resp-subscribe-button__link umami--click--support-kofi" href=https://ko-fi.com/genezini target=_blank value="☕ Ko-fi" aria-label="☕ Ko-fi"><div class="resp-subscribe-button resp-subscribe-button--coffee resp-subscribe-button--medium"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-mug" width="16" height="16" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4.083 5h10.834A1.08 1.08.0 0116 6.077v8.615C16 17.072 14.06 19 11.667 19H7.333C4.94 19 3 17.071 3 14.692V6.077A1.08 1.08.0 014.083 5"/><path d="M16 8h2.5c1.38.0 2.5 1.045 2.5 2.333v2.334C21 13.955 19.88 15 18.5 15H16"/></svg> Ko-fi</div></a><a class="resp-subscribe-button__link umami--click--support-github" href=https://github.com/sponsors/dgenezini/ target=_blank value="GitHub Sponsor" aria-label="GitHub Sponsor"><div class="resp-subscribe-button resp-subscribe-button--github resp-subscribe-button--medium"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="16" height="16" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg> GitHub Sponsor</div></a></div><span class=subscribe-title>Tags</span><section class=article-tags><a href=/pt/tags/testes/ class=umami--click--tags-bottom--pt-tags-testes->Testes</a>
<a href=/pt/tags/testes-automatizados/ class=umami--click--tags-bottom--pt-tags-testes-automatizados->Testes Automatizados</a>
<a href=/pt/tags/testes-de-integra%C3%A7%C3%A3o/ class=umami--click--tags-bottom--pt-tags-testes-de-integra%C3%A7%C3%A3o->Testes De Integração</a>
<a href=/pt/tags/wiremock.net/ class=umami--click--tags-bottom--pt-tags-wiremock-net->WireMock.Net</a>
<a href=/pt/tags/asp.net-core/ class=umami--click--tags-bottom--pt-tags-asp-net-core->ASP.NET Core</a>
<a href=/pt/tags/dotnet/ class=umami--click--tags-bottom--pt-tags-dotnet->.NET</a>
<a href=/pt/tags/c-sharp/ class=umami--click--tags-bottom--pt-tags-c-sharp->C#</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Conteúdo relacionado</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/pt/p/analisando-e-validando-cobertura-de-codigo-no-.net-com-coverlet/ class=umami--click--related-bottom--ptanalisando-e-validando-cobertura-de-codigo-no-net-com-coverlet-><div class=article-image><img src=/pt/p/analisando-e-validando-cobertura-de-codigo-no-.net-com-coverlet/cover.pt.f90665892b5e0c79dd22f617a56d611f.png width=1300 height=250 loading=lazy alt="Featured image of post Analisando e validando cobertura de código no .NET com Coverlet" data-key=analisando-e-validando-cobertura-de-codigo-no-.net-com-coverlet data-hash="md5-+QZliSteDHndIvYXpW1hHw=="></div><div class=article-details><h2 class=article-title>Analisando e validando cobertura de código no .NET com Coverlet</h2></div></a></article><article class=has-image><a href=/pt/p/validando-regras-de-estilo-de-codigo-no-.net-em-tempo-de-compilacao/ class=umami--click--related-bottom--ptvalidando-regras-de-estilo-de-codigo-no-net-em-tempo-de-compilacao-><div class=article-image><img src=/pt/p/validando-regras-de-estilo-de-codigo-no-.net-em-tempo-de-compilacao/cover.pt.91a831076e2dc02471933dbf3c9fe50b.png width=1300 height=250 loading=lazy alt="Featured image of post Validando regras de estilo de código no .NET em tempo de compilação" data-key=validando-regras-de-estilo-de-codigo-no-.net-em-tempo-de-compilacao data-hash="md5-kagxB24twCRxkz2/PJ/lCw=="></div><div class=article-details><h2 class=article-title>Validando regras de estilo de código no .NET em tempo de compilação</h2></div></a></article><article class=has-image><a href=/pt/p/definindo-regras-de-formatacao-no-.net-com-editorconfig/ class=umami--click--related-bottom--ptdefinindo-regras-de-formatacao-no-net-com-editorconfig-><div class=article-image><img src=/pt/p/definindo-regras-de-formatacao-no-.net-com-editorconfig/cover.pt.4159b96fc67583abeb5579415fdfe2fe.png width=1300 height=250 loading=lazy alt="Featured image of post Definindo regras de formatação no .NET com EditorConfig" data-key=definindo-regras-de-formatacao-no-.net-com-editorconfig data-hash="md5-QVm5b8Z1g6vrVXlBX9/i/g=="></div><div class=article-details><h2 class=article-title>Definindo regras de formatação no .NET com EditorConfig</h2></div></a></article></div></div></aside><div id=comments><script src=https://giscus.app/client.js data-repo=dgenezini/BlogComments data-repo-id=R_kgDOJj-XAw data-category=Announcements data-category-id=DIC_kwDOJj-XA84CWiZs data-mapping=og:title data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=light data-lang=en data-loading=lazy crossorigin=anonymous async></script><script>function setGiscusTheme(e){let t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:{setConfig:{theme:e}}},"https://giscus.app")}(function(){addEventListener("message",t=>{if(event.origin!=="https://giscus.app")return;e()}),window.addEventListener("onColorSchemeChange",e);function e(){setGiscusTheme(document.documentElement.dataset.scheme==="light"?"light":"dark_dimmed")}})()</script></div><footer class=site-footer><section class=copyright>&copy;
2022 -
2024 Daniel Genezini | It works on my machine</section><section class=powerby>Criado com <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Tema <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.13.0>Stack</a></b> desenvolvido por <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main><aside class="sidebar right-sidebar sticky"><section class="widget archives"><h2 class="widget-title section-title">Conteúdo relacionado</h2><div class=article-list--mini><article><a href=/pt/p/analisando-e-validando-cobertura-de-codigo-no-.net-com-coverlet/ class=umami--click--related-side--ptanalisando-e-validando-cobertura-de-codigo-no--net-com-coverlet-><div class=article-details><h2 class=article-title>Analisando e validando cobertura de código no .NET com Coverlet</h2><footer class=article-time><time datetime=2022-11-03T08:10:00-03:00>03 Nov 2022</time></footer></div><div class=article-image><img src=/pt/p/analisando-e-validando-cobertura-de-codigo-no-.net-com-coverlet/cover.pt.png width=1300 height=250 alt="Analisando e validando cobertura de código no .NET com Coverlet" loading=lazy></div></a></article><article><a href=/pt/p/validando-regras-de-estilo-de-codigo-no-.net-em-tempo-de-compilacao/ class=umami--click--related-side--ptvalidando-regras-de-estilo-de-codigo-no--net-em-tempo-de-compilacao-><div class=article-details><h2 class=article-title>Validando regras de estilo de código no .NET em tempo de compilação</h2><footer class=article-time><time datetime=2022-10-25T08:30:00-03:00>25 Oct 2022</time></footer></div><div class=article-image><img src=/pt/p/validando-regras-de-estilo-de-codigo-no-.net-em-tempo-de-compilacao/cover.pt.png width=1300 height=250 alt="Validando regras de estilo de código no .NET em tempo de compilação" loading=lazy></div></a></article><article><a href=/pt/p/definindo-regras-de-formatacao-no-.net-com-editorconfig/ class=umami--click--related-side--ptdefinindo-regras-de-formatacao-no--net-com-editorconfig-><div class=article-details><h2 class=article-title>Definindo regras de formatação no .NET com EditorConfig</h2><footer class=article-time><time datetime=2022-10-18T08:00:00-03:00>18 Oct 2022</time></footer></div><div class=article-image><img src=/pt/p/definindo-regras-de-formatacao-no-.net-com-editorconfig/cover.pt.png width=1300 height=250 alt="Definindo regras de formatação no .NET com EditorConfig" loading=lazy></div></a></article></div></section><section class="widget archives"><h2 class="widget-title section-title">Posts recentes</h2><div class=article-list--mini><article><a href=/pt/p/apresentando-module-federation-para-blazor/ class=umami--click--recentposts--ptapresentando-module-federation-para-blazor-><div class=article-details><h2 class=article-title>Apresentando module federation para Blazor</h2><footer class=article-time><time datetime=2022-11-17T09:50:00-03:00>17 Nov 2022</time></footer></div><div class=article-image><img src=/p/introducing-module-federation-for-blazor-components/cover.jpg width=1500 height=996 alt="Apresentando module federation para Blazor" loading=lazy></div></a></article><article><a href=/pt/p/analisando-e-validando-cobertura-de-codigo-no-.net-com-coverlet/ class=umami--click--recentposts--ptanalisando-e-validando-cobertura-de-codigo-no--net-com-coverlet-><div class=article-details><h2 class=article-title>Analisando e validando cobertura de código no .NET com Coverlet</h2><footer class=article-time><time datetime=2022-11-03T08:10:00-03:00>03 Nov 2022</time></footer></div><div class=article-image><img src=/pt/p/analisando-e-validando-cobertura-de-codigo-no-.net-com-coverlet/cover.pt.png width=1300 height=250 alt="Analisando e validando cobertura de código no .NET com Coverlet" loading=lazy></div></a></article><article><a href=/pt/p/validando-regras-de-estilo-de-codigo-no-.net-em-tempo-de-compilacao/ class=umami--click--recentposts--ptvalidando-regras-de-estilo-de-codigo-no--net-em-tempo-de-compilacao-><div class=article-details><h2 class=article-title>Validando regras de estilo de código no .NET em tempo de compilação</h2><footer class=article-time><time datetime=2022-10-25T08:30:00-03:00>25 Oct 2022</time></footer></div><div class=article-image><img src=/pt/p/validando-regras-de-estilo-de-codigo-no-.net-em-tempo-de-compilacao/cover.pt.png width=1300 height=250 alt="Validando regras de estilo de código no .NET em tempo de compilação" loading=lazy></div></a></article><article><a href=/pt/p/definindo-regras-de-formatacao-no-.net-com-editorconfig/ class=umami--click--recentposts--ptdefinindo-regras-de-formatacao-no--net-com-editorconfig-><div class=article-details><h2 class=article-title>Definindo regras de formatação no .NET com EditorConfig</h2><footer class=article-time><time datetime=2022-10-18T08:00:00-03:00>18 Oct 2022</time></footer></div><div class=article-image><img src=/pt/p/definindo-regras-de-formatacao-no-.net-com-editorconfig/cover.pt.png width=1300 height=250 alt="Definindo regras de formatação no .NET com EditorConfig" loading=lazy></div></a></article><article><a href=/pt/p/extensoes-do-vs-code-que-vale-a-pena-testar/ class=umami--click--recentposts--ptextensoes-do-vs-code-que-vale-a-pena-testar-><div class=article-details><h2 class=article-title>Extensões do VS Code que vale a pena testar</h2><footer class=article-time><time datetime=2022-10-11T07:00:00-03:00>11 Oct 2022</time></footer></div><div class=article-image><img src=/pt/p/extensoes-do-vs-code-que-vale-a-pena-testar/cover.pt.png width=1300 height=250 alt="Extensões do VS Code que vale a pena testar" loading=lazy></div></a></article></div></section></aside></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script><script src=https://storage.ko-fi.com/cdn/scripts/overlay-widget.js></script><script>kofiWidgetOverlay.draw("genezini",{type:"floating-chat","floating-chat.donateButton.text":"Support me","floating-chat.donateButton.background-color":"#d9534f","floating-chat.donateButton.text-color":"#fff"})</script></body></html>